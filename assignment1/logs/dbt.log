[0m11:18:41.411660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C02ADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C083150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C082B50>]}


============================== 11:18:41.411660 | 2c237843-4527-4ce7-b73e-9b15b5bc8fe5 ==============================
[0m11:18:41.411660 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:18:41.411660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:18:41.678872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c237843-4527-4ce7-b73e-9b15b5bc8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C0C5010>]}
[0m11:18:41.725740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c237843-4527-4ce7-b73e-9b15b5bc8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C097D90>]}
[0m11:18:41.741362 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:18:41.759127 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:18:41.759127 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m11:18:41.759127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2c237843-4527-4ce7-b73e-9b15b5bc8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C509F50>]}
[0m11:18:43.518790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c237843-4527-4ce7-b73e-9b15b5bc8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C800BD0>]}
[0m11:18:43.540220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c237843-4527-4ce7-b73e-9b15b5bc8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C5B7110>]}
[0m11:18:43.540220 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:18:43.541220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c237843-4527-4ce7-b73e-9b15b5bc8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0CD0FED0>]}
[0m11:18:43.542221 [info ] [MainThread]: 
[0m11:18:43.543220 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:18:43.544220 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:18:43.553243 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:18:43.554242 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:18:43.554242 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:43.568150 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:18:43.569408 [debug] [ThreadPool]: On list_dev: Close
[0m11:18:43.569741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:18:43.569741 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:18:43.569741 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:18:43.569741 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:18:43.569741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:18:43.584940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:18:43.584940 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:18:43.584940 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:18:43.584940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:18:43.584940 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:18:43.584940 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:18:43.584940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:18:43.584940 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:18:43.584940 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:18:43.584940 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:18:43.584940 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:18:43.584940 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:18:43.599724 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:18:43.601160 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:18:43.601160 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:18:43.601160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:43.601160 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:18:43.601160 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:18:43.601160 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:18:43.643383 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:18:43.644409 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:18:43.650390 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:18:43.650390 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:18:43.650390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c237843-4527-4ce7-b73e-9b15b5bc8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C8F9490>]}
[0m11:18:43.650390 [debug] [MainThread]: Using duckdb connection "master"
[0m11:18:43.650390 [debug] [MainThread]: On master: BEGIN
[0m11:18:43.650390 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:18:43.650390 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:18:43.650390 [debug] [MainThread]: On master: COMMIT
[0m11:18:43.650390 [debug] [MainThread]: Using duckdb connection "master"
[0m11:18:43.650390 [debug] [MainThread]: On master: COMMIT
[0m11:18:43.650390 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:18:43.650390 [debug] [MainThread]: On master: Close
[0m11:18:43.666685 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:18:43.666685 [info ] [MainThread]: 
[0m11:18:43.666685 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:18:43.666685 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:18:43.684308 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:18:43.685355 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:18:43.687013 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:18:43.687013 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:18:43.685355 => 11:18:43.687013
[0m11:18:43.687013 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:18:43.720405 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:18:43.720921 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:18:43.720921 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:18:43.720921 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:18:43.720921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:18:43.720921 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:18:43.720921 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:18:43.720921 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:18:43.735654 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:18:43.735654 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:18:43.735654 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:18:43.750847 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:18:43.751636 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:18:43.751636 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:18:43.751636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:18:43.751636 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:18:43.751636 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:18:43.751636 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:18:43.751636 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:18:43.687013 => 11:18:43.751636
[0m11:18:43.751636 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:18:43.770534 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c237843-4527-4ce7-b73e-9b15b5bc8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C5B5F10>]}
[0m11:18:43.770534 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m11:18:43.771535 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:18:43.772548 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:18:43.772548 [info ] [Thread-1 (]: 2 of 3 START sql table model main.test ......................................... [RUN]
[0m11:18:43.773536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:18:43.774536 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:18:43.776535 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:18:43.777536 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:18:43.774536 => 11:18:43.777536
[0m11:18:43.777536 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:18:43.780536 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:18:43.783543 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:18:43.783543 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:18:43.784536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:43.800372 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:18:43.800372 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:18:43.800372 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      

SELECT *
FROM dataset_name
WHERE disability = 'Y';
    );
  
  
[0m11:18:43.800372 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:18:43.778548 => 11:18:43.800372
[0m11:18:43.800372 [debug] [Thread-1 (]: On model.assignment1.test: ROLLBACK
[0m11:18:43.899570 [debug] [Thread-1 (]: Failed to rollback 'model.assignment1.test'
[0m11:18:43.899570 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:18:43.915217 [debug] [Thread-1 (]: Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near ";"
[0m11:18:43.915217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c237843-4527-4ce7-b73e-9b15b5bc8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C4EB150>]}
[0m11:18:43.915217 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.test ................................ [[31mERROR[0m in 0.14s]
[0m11:18:43.915217 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:18:43.915217 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:18:43.915217 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:18:43.915217 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:18:43.929343 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:18:43.934638 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:18:43.935239 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:18:43.930180 => 11:18:43.935239
[0m11:18:43.935239 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:18:43.950337 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:18:43.950337 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:18:43.950337 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:18:43.950337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:18:43.950337 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:18:43.965346 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:18:43.966208 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:18:43.966859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:18:43.966859 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:18:43.966859 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:18:43.966859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:18:43.966859 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:18:43.966859 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:18:43.966859 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:18:43.966859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:18:43.966859 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:18:43.966859 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:18:43.966859 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:18:43.966859 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:18:43.935239 => 11:18:43.966859
[0m11:18:43.966859 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:18:43.983954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c237843-4527-4ce7-b73e-9b15b5bc8fe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0CD9BB10>]}
[0m11:18:43.983954 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m11:18:43.983954 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:18:43.983954 [debug] [MainThread]: Using duckdb connection "master"
[0m11:18:43.983954 [debug] [MainThread]: On master: BEGIN
[0m11:18:43.983954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:18:44.000591 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:18:44.000591 [debug] [MainThread]: On master: COMMIT
[0m11:18:44.000591 [debug] [MainThread]: Using duckdb connection "master"
[0m11:18:44.000591 [debug] [MainThread]: On master: COMMIT
[0m11:18:44.000591 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:18:44.000591 [debug] [MainThread]: On master: Close
[0m11:18:44.000591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:44.000591 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:18:44.016072 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:18:44.017319 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:18:44.017319 [info ] [MainThread]: 
[0m11:18:44.017319 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.47 seconds (0.47s).
[0m11:18:44.017319 [debug] [MainThread]: Command end result
[0m11:18:44.017319 [info ] [MainThread]: 
[0m11:18:44.017319 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:18:44.017319 [info ] [MainThread]: 
[0m11:18:44.032818 [error] [MainThread]:   Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near ";"
[0m11:18:44.034120 [info ] [MainThread]: 
[0m11:18:44.034120 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:18:44.034120 [debug] [MainThread]: Command `dbt run` failed at 11:18:44.034120 after 2.67 seconds
[0m11:18:44.034120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0638C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0BE7C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB0C032850>]}
[0m11:18:44.034120 [debug] [MainThread]: Flushing usage events
[0m11:19:48.934056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027856E82B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027856E839D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278556473D0>]}


============================== 11:19:48.934056 | 57ba3bca-e543-474c-9b36-bf64a491233a ==============================
[0m11:19:48.934056 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:19:48.934056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:19:49.085204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57ba3bca-e543-474c-9b36-bf64a491233a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785723CED0>]}
[0m11:19:49.137539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57ba3bca-e543-474c-9b36-bf64a491233a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027856EE2410>]}
[0m11:19:49.137539 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:19:49.137539 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:19:49.221535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:19:49.221535 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:19:49.302093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57ba3bca-e543-474c-9b36-bf64a491233a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027857683F10>]}
[0m11:19:49.302093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57ba3bca-e543-474c-9b36-bf64a491233a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278573E8350>]}
[0m11:19:49.302093 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:19:49.302093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ba3bca-e543-474c-9b36-bf64a491233a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027857278B50>]}
[0m11:19:49.317725 [info ] [MainThread]: 
[0m11:19:49.317725 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:19:49.317725 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:19:49.317725 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:19:49.317725 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:19:49.317725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:49.333339 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:49.333339 [debug] [ThreadPool]: On list_dev: Close
[0m11:19:49.333339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:19:49.333339 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:19:49.333339 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:19:49.333339 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:19:49.333339 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:19:49.356080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:49.356080 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:19:49.356080 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:19:49.356080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:49.356080 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:19:49.356080 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:19:49.356080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:49.356080 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:19:49.356080 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:19:49.356080 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:19:49.356080 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:49.356080 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:19:49.356080 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:19:49.356080 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:19:49.356080 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:19:49.356080 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:19:49.376765 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:49.377776 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:19:49.377776 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:19:49.405703 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:19:49.405703 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:19:49.405703 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:19:49.405703 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:19:49.405703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57ba3bca-e543-474c-9b36-bf64a491233a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027857338E10>]}
[0m11:19:49.405703 [debug] [MainThread]: Using duckdb connection "master"
[0m11:19:49.405703 [debug] [MainThread]: On master: BEGIN
[0m11:19:49.405703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:19:49.421462 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:19:49.421462 [debug] [MainThread]: On master: COMMIT
[0m11:19:49.421462 [debug] [MainThread]: Using duckdb connection "master"
[0m11:19:49.421462 [debug] [MainThread]: On master: COMMIT
[0m11:19:49.421462 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:19:49.421462 [debug] [MainThread]: On master: Close
[0m11:19:49.421462 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:19:49.421462 [info ] [MainThread]: 
[0m11:19:49.421462 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:19:49.421462 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:19:49.421462 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:19:49.421462 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:19:49.437084 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:19:49.437084 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:19:49.421462 => 11:19:49.437084
[0m11:19:49.437084 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:19:49.467622 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:19:49.468623 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:19:49.468623 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:19:49.469633 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:19:49.471767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.471767 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:19:49.471767 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:19:49.471767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.471767 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:19:49.471767 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:19:49.471767 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.488508 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:19:49.488508 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:19:49.488508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.504659 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:19:49.505809 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:19:49.505809 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:19:49.508796 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.512792 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:19:49.513790 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:19:49.515752 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.517775 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:19:49.437084 => 11:19:49.516778
[0m11:19:49.517775 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:19:49.524786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57ba3bca-e543-474c-9b36-bf64a491233a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278573686D0>]}
[0m11:19:49.524786 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m11:19:49.525785 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:19:49.525785 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:19:49.526810 [info ] [Thread-1 (]: 2 of 3 START sql table model main.test ......................................... [RUN]
[0m11:19:49.527800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:19:49.527800 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:19:49.529787 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:19:49.530792 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:19:49.527800 => 11:19:49.530792
[0m11:19:49.530792 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:19:49.533783 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:19:49.534807 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:19:49.534807 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:19:49.534807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:49.538920 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.538920 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:19:49.538920 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      

SELECT *
FROM 'data/studentInfo.csv'
WHERE disability = 'Y';
    );
  
  
[0m11:19:49.538920 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:19:49.531809 => 11:19:49.538920
[0m11:19:49.538920 [debug] [Thread-1 (]: On model.assignment1.test: ROLLBACK
[0m11:19:49.538920 [debug] [Thread-1 (]: Failed to rollback 'model.assignment1.test'
[0m11:19:49.538920 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:19:49.556851 [debug] [Thread-1 (]: Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near ";"
[0m11:19:49.556851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57ba3bca-e543-474c-9b36-bf64a491233a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000278573686D0>]}
[0m11:19:49.558192 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.test ................................ [[31mERROR[0m in 0.03s]
[0m11:19:49.558535 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:19:49.558535 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:19:49.558535 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:19:49.558535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:19:49.558535 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:19:49.558535 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:19:49.558535 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:19:49.558535 => 11:19:49.558535
[0m11:19:49.558535 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:19:49.573191 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:19:49.573191 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:19:49.573191 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:19:49.573191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:19:49.573191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.573191 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:19:49.573191 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:19:49.573191 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.590198 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:19:49.591210 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:19:49.592986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.592986 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:19:49.592986 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:19:49.592986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.592986 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:19:49.592986 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:19:49.592986 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:19:49.592986 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.592986 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:19:49.592986 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:19:49.605924 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:19:49.605924 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:19:49.558535 => 11:19:49.605924
[0m11:19:49.605924 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:19:49.605924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57ba3bca-e543-474c-9b36-bf64a491233a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027857A14FD0>]}
[0m11:19:49.605924 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m11:19:49.605924 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:19:49.605924 [debug] [MainThread]: Using duckdb connection "master"
[0m11:19:49.605924 [debug] [MainThread]: On master: BEGIN
[0m11:19:49.605924 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:19:49.630479 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:19:49.630479 [debug] [MainThread]: On master: COMMIT
[0m11:19:49.631498 [debug] [MainThread]: Using duckdb connection "master"
[0m11:19:49.631498 [debug] [MainThread]: On master: COMMIT
[0m11:19:49.631498 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:19:49.632523 [debug] [MainThread]: On master: Close
[0m11:19:49.634462 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:19:49.635479 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:19:49.635479 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:19:49.635479 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:19:49.636490 [info ] [MainThread]: 
[0m11:19:49.638014 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m11:19:49.639075 [debug] [MainThread]: Command end result
[0m11:19:49.646133 [info ] [MainThread]: 
[0m11:19:49.647153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:19:49.648121 [info ] [MainThread]: 
[0m11:19:49.649076 [error] [MainThread]:   Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near ";"
[0m11:19:49.651113 [info ] [MainThread]: 
[0m11:19:49.651113 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:19:49.654567 [debug] [MainThread]: Command `dbt run` failed at 11:19:49.653277 after 0.77 seconds
[0m11:19:49.654567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785109C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002785116EB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027851129BD0>]}
[0m11:19:49.655679 [debug] [MainThread]: Flushing usage events
[0m11:21:05.339369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159C682B10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159C636250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159C635E10>]}


============================== 11:21:05.339369 | c7ab88a8-67f5-4a11-9b85-e567afeb4b4b ==============================
[0m11:21:05.339369 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:21:05.348507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:21:05.500695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7ab88a8-67f5-4a11-9b85-e567afeb4b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159C6CD350>]}
[0m11:21:05.567751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7ab88a8-67f5-4a11-9b85-e567afeb4b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159C7D0DD0>]}
[0m11:21:05.567751 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:21:05.571717 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:21:05.634433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:21:05.635962 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:21:05.715834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7ab88a8-67f5-4a11-9b85-e567afeb4b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159C6CA510>]}
[0m11:21:05.735673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7ab88a8-67f5-4a11-9b85-e567afeb4b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159CF646D0>]}
[0m11:21:05.735673 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:21:05.735673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7ab88a8-67f5-4a11-9b85-e567afeb4b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159CA6C9D0>]}
[0m11:21:05.738528 [info ] [MainThread]: 
[0m11:21:05.738528 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:21:05.738528 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:21:05.750785 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:21:05.751783 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:21:05.751783 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:05.754954 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:05.754954 [debug] [ThreadPool]: On list_dev: Close
[0m11:21:05.767099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:21:05.769471 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:21:05.769471 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:21:05.769471 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:21:05.769471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:05.784278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:05.784278 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:21:05.784278 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:21:05.784278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:05.784278 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:21:05.784278 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:21:05.784278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:05.784278 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:21:05.784278 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:21:05.784278 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:21:05.784278 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:05.784278 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:21:05.784278 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:21:05.800353 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:21:05.800353 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:21:05.800353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:05.800353 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:05.800353 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:21:05.800353 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:21:05.840770 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:05.844755 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:21:05.845766 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:21:05.846820 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:21:05.850757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7ab88a8-67f5-4a11-9b85-e567afeb4b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159CF40610>]}
[0m11:21:05.850757 [debug] [MainThread]: Using duckdb connection "master"
[0m11:21:05.851863 [debug] [MainThread]: On master: BEGIN
[0m11:21:05.851863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:21:05.857793 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:21:05.858861 [debug] [MainThread]: On master: COMMIT
[0m11:21:05.858861 [debug] [MainThread]: Using duckdb connection "master"
[0m11:21:05.858861 [debug] [MainThread]: On master: COMMIT
[0m11:21:05.859807 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:21:05.859807 [debug] [MainThread]: On master: Close
[0m11:21:05.861852 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:21:05.862831 [info ] [MainThread]: 
[0m11:21:05.865873 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:21:05.866384 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:21:05.866384 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:21:05.866384 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:21:05.866384 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:21:05.866384 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:21:05.866384 => 11:21:05.866384
[0m11:21:05.866384 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:21:05.901790 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:21:05.903740 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:05.904741 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:21:05.904741 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:21:05.906459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:05.906459 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:05.906459 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:21:05.906459 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:05.919285 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:05.919285 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:21:05.919285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:05.919285 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:05.919285 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:21:05.919285 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:05.938281 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:21:05.938281 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:05.938281 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:21:05.938281 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:05.938281 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:05.949688 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:21:05.951706 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:05.952752 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:21:05.866384 => 11:21:05.952752
[0m11:21:05.953817 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:21:05.959593 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ab88a8-67f5-4a11-9b85-e567afeb4b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159CFA71D0>]}
[0m11:21:05.960604 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m11:21:05.961655 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:21:05.962650 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:21:05.962650 [info ] [Thread-1 (]: 2 of 3 START sql table model main.test ......................................... [RUN]
[0m11:21:05.963679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:21:05.963679 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:21:05.966844 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:21:05.967920 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:21:05.964701 => 11:21:05.967920
[0m11:21:05.968890 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:21:05.971886 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:21:05.972838 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:21:05.972838 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:21:05.972838 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:05.984396 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:05.985399 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:21:05.985399 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      

with dim_dis AS(
SELECT *
FROM 'data/studentInfo.csv'
WHERE disability = 'Y';
)

SELECT
  *
FROM dim_dis
    );
  
  
[0m11:21:05.987427 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:21:05.968890 => 11:21:05.986502
[0m11:21:05.987427 [debug] [Thread-1 (]: On model.assignment1.test: ROLLBACK
[0m11:21:05.988577 [debug] [Thread-1 (]: Failed to rollback 'model.assignment1.test'
[0m11:21:05.988577 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:21:05.988577 [debug] [Thread-1 (]: Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near ";"
[0m11:21:05.988577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ab88a8-67f5-4a11-9b85-e567afeb4b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159CB71C50>]}
[0m11:21:06.000757 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model main.test ................................ [[31mERROR[0m in 0.02s]
[0m11:21:06.001812 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:21:06.002721 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:21:06.003715 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:21:06.004739 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:21:06.006243 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:21:06.006243 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:21:06.006243 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:21:06.006243 => 11:21:06.006243
[0m11:21:06.006243 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:21:06.019821 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:21:06.019821 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:06.019821 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:21:06.019821 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:06.033944 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:06.034976 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:06.035990 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:21:06.037013 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:06.038750 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:06.038750 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:21:06.038750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:06.038750 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:06.038750 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:21:06.038750 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:06.038750 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:21:06.038750 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:06.038750 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:21:06.049485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:06.052495 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:06.053495 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:21:06.054816 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:06.054816 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:21:06.006243 => 11:21:06.054816
[0m11:21:06.054816 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:21:06.054816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ab88a8-67f5-4a11-9b85-e567afeb4b4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159CAEBD90>]}
[0m11:21:06.054816 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m11:21:06.067224 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:21:06.070625 [debug] [MainThread]: Using duckdb connection "master"
[0m11:21:06.070625 [debug] [MainThread]: On master: BEGIN
[0m11:21:06.070625 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:21:06.070625 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:21:06.070625 [debug] [MainThread]: On master: COMMIT
[0m11:21:06.083850 [debug] [MainThread]: Using duckdb connection "master"
[0m11:21:06.083850 [debug] [MainThread]: On master: COMMIT
[0m11:21:06.084953 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:21:06.085866 [debug] [MainThread]: On master: Close
[0m11:21:06.085866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:06.085866 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:21:06.085866 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:21:06.085866 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:21:06.085866 [info ] [MainThread]: 
[0m11:21:06.085866 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:21:06.085866 [debug] [MainThread]: Command end result
[0m11:21:06.085866 [info ] [MainThread]: 
[0m11:21:06.099680 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:21:06.100774 [info ] [MainThread]: 
[0m11:21:06.101731 [error] [MainThread]:   Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near ";"
[0m11:21:06.102724 [info ] [MainThread]: 
[0m11:21:06.103724 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:21:06.104680 [debug] [MainThread]: Command `dbt run` failed at 11:21:06.104680 after 0.81 seconds
[0m11:21:06.104680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159698C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021596A5F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021596A5F690>]}
[0m11:21:06.104680 [debug] [MainThread]: Flushing usage events
[0m11:21:21.773229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6CB82AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6CB4EB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6CB4C550>]}


============================== 11:21:21.773229 | 80fbb30c-81df-49fa-81c3-9aa3cf635e32 ==============================
[0m11:21:21.773229 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:21:21.773229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:21:21.934344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80fbb30c-81df-49fa-81c3-9aa3cf635e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6CF1BF90>]}
[0m11:21:21.996777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80fbb30c-81df-49fa-81c3-9aa3cf635e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6CE91BD0>]}
[0m11:21:21.996777 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:21:21.996777 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:21:22.053559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:21:22.070096 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:21:22.149825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80fbb30c-81df-49fa-81c3-9aa3cf635e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6D3B19D0>]}
[0m11:21:22.165346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80fbb30c-81df-49fa-81c3-9aa3cf635e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6D2F0C90>]}
[0m11:21:22.165346 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:21:22.165346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80fbb30c-81df-49fa-81c3-9aa3cf635e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6D440850>]}
[0m11:21:22.165346 [info ] [MainThread]: 
[0m11:21:22.165346 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:21:22.165346 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:21:22.186295 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:21:22.186295 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:21:22.186295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:22.186295 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:22.186295 [debug] [ThreadPool]: On list_dev: Close
[0m11:21:22.201771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:21:22.201771 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:21:22.201771 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:21:22.201771 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:21:22.201771 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:21:22.201771 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:22.217641 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:21:22.218220 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:21:22.218220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:22.218220 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:21:22.218220 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:21:22.218220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:22.218220 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:21:22.218220 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:21:22.218220 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:21:22.218220 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:22.218220 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:21:22.218220 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:21:22.218220 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:21:22.218220 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:21:22.218220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:21:22.235130 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:22.235130 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:21:22.235130 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:21:22.268928 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:21:22.268928 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:21:22.268928 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:21:22.268928 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:21:22.268928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80fbb30c-81df-49fa-81c3-9aa3cf635e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6D28AE10>]}
[0m11:21:22.268928 [debug] [MainThread]: Using duckdb connection "master"
[0m11:21:22.268928 [debug] [MainThread]: On master: BEGIN
[0m11:21:22.268928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:21:22.287346 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:21:22.288345 [debug] [MainThread]: On master: COMMIT
[0m11:21:22.288345 [debug] [MainThread]: Using duckdb connection "master"
[0m11:21:22.288345 [debug] [MainThread]: On master: COMMIT
[0m11:21:22.289346 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:21:22.289346 [debug] [MainThread]: On master: Close
[0m11:21:22.291368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:21:22.291986 [info ] [MainThread]: 
[0m11:21:22.294075 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:21:22.295034 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:21:22.295034 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:21:22.296089 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:21:22.300945 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:21:22.301954 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:21:22.296089 => 11:21:22.301954
[0m11:21:22.303302 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:21:22.318343 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:21:22.318343 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:22.318343 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:21:22.318343 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:21:22.335680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.335680 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:22.335680 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:21:22.335680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.335680 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:22.335680 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:21:22.335680 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.335680 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:22.351069 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:21:22.353840 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.368858 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:21:22.368858 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:22.368858 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:21:22.368858 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.368858 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:21:22.368858 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:21:22.382905 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.385521 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:21:22.303302 => 11:21:22.385521
[0m11:21:22.386176 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:21:22.392854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80fbb30c-81df-49fa-81c3-9aa3cf635e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6CFAC850>]}
[0m11:21:22.392854 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m11:21:22.392854 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:21:22.392854 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:21:22.392854 [info ] [Thread-1 (]: 2 of 3 START sql table model main.test ......................................... [RUN]
[0m11:21:22.392854 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:21:22.392854 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:21:22.400383 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:21:22.402876 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:21:22.392854 => 11:21:22.401874
[0m11:21:22.402876 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:21:22.406411 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:21:22.406411 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:21:22.406411 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:21:22.406411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:22.419876 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.421300 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:21:22.421300 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      

with dim_dis AS(
SELECT *
FROM 'data/studentInfo.csv'
WHERE disability = 'Y'
)

SELECT
  *
FROM dim_dis
    );
  
  
[0m11:21:22.486328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.486328 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:21:22.486328 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter table "dev"."main"."test__dbt_tmp" rename to "test"
[0m11:21:22.486328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.500816 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:21:22.501863 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:21:22.501863 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:21:22.505938 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.507935 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:21:22.507935 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_backup" cascade
[0m11:21:22.508934 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.509981 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:21:22.403926 => 11:21:22.509981
[0m11:21:22.511023 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:21:22.528932 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80fbb30c-81df-49fa-81c3-9aa3cf635e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6D515050>]}
[0m11:21:22.529978 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.test .................................... [[32mOK[0m in 0.14s]
[0m11:21:22.530973 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:21:22.532029 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:21:22.532979 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:21:22.533976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:21:22.533976 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:21:22.535032 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:21:22.535032 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:21:22.535032 => 11:21:22.535032
[0m11:21:22.535032 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:21:22.550711 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:21:22.552502 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:22.553514 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:21:22.553514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:21:22.567400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.568416 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:22.569412 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:21:22.569412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.570446 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:22.570446 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:21:22.570446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.570446 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:22.570446 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:21:22.570446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.570446 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:21:22.570446 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:22.570446 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:21:22.570446 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.585050 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:21:22.586049 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:21:22.588051 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:21:22.589032 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:21:22.535032 => 11:21:22.589032
[0m11:21:22.589032 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:21:22.595586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80fbb30c-81df-49fa-81c3-9aa3cf635e32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6D4EE690>]}
[0m11:21:22.595586 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m11:21:22.595586 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:21:22.595586 [debug] [MainThread]: Using duckdb connection "master"
[0m11:21:22.595586 [debug] [MainThread]: On master: BEGIN
[0m11:21:22.600723 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:21:22.603846 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:21:22.620819 [debug] [MainThread]: On master: COMMIT
[0m11:21:22.620819 [debug] [MainThread]: Using duckdb connection "master"
[0m11:21:22.620819 [debug] [MainThread]: On master: COMMIT
[0m11:21:22.620819 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:21:22.620819 [debug] [MainThread]: On master: Close
[0m11:21:22.623912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:21:22.623912 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:21:22.623912 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:21:22.623912 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:21:22.623912 [info ] [MainThread]: 
[0m11:21:22.623912 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m11:21:22.623912 [debug] [MainThread]: Command end result
[0m11:21:22.635936 [info ] [MainThread]: 
[0m11:21:22.636948 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:21:22.637981 [info ] [MainThread]: 
[0m11:21:22.639389 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:21:22.639389 [debug] [MainThread]: Command `dbt run` succeeded at 11:21:22.639389 after 0.91 seconds
[0m11:21:22.639389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F66E8C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F6CB7A890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F67118E10>]}
[0m11:21:22.639389 [debug] [MainThread]: Flushing usage events
[0m11:22:26.284108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A954CED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A954E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A954CE10>]}


============================== 11:22:26.292381 | ee1963e0-8cfa-4f6f-b6fd-8ece558088d6 ==============================
[0m11:22:26.292381 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:22:26.292381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:22:26.442959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee1963e0-8cfa-4f6f-b6fd-8ece558088d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A991CED0>]}
[0m11:22:26.508991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee1963e0-8cfa-4f6f-b6fd-8ece558088d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A8D46B10>]}
[0m11:22:26.508991 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:22:26.508991 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:22:26.593652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:22:26.593652 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:22:26.691437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee1963e0-8cfa-4f6f-b6fd-8ece558088d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A9C706D0>]}
[0m11:22:26.693739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee1963e0-8cfa-4f6f-b6fd-8ece558088d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A9CF0350>]}
[0m11:22:26.702452 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:22:26.703160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee1963e0-8cfa-4f6f-b6fd-8ece558088d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A9E25490>]}
[0m11:22:26.703160 [info ] [MainThread]: 
[0m11:22:26.705905 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:22:26.705905 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:22:26.707961 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:22:26.707961 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:22:26.707961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:26.724083 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:26.726486 [debug] [ThreadPool]: On list_dev: Close
[0m11:22:26.727603 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:22:26.727603 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:22:26.727603 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:22:26.727603 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:22:26.727603 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:22:26.741731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:26.741731 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:22:26.741731 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:22:26.741731 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:26.746540 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:22:26.746540 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:22:26.747554 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:26.747554 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:22:26.747554 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:22:26.747554 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:22:26.747554 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:26.747554 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:22:26.751320 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:22:26.756956 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:22:26.758156 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:22:26.758987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:26.759550 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:26.759550 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:22:26.759550 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:22:26.791587 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:26.791587 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:22:26.791587 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:22:26.791587 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:22:26.807284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee1963e0-8cfa-4f6f-b6fd-8ece558088d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A99B8710>]}
[0m11:22:26.809486 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:26.810535 [debug] [MainThread]: On master: BEGIN
[0m11:22:26.811485 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:22:26.817806 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:22:26.817806 [debug] [MainThread]: On master: COMMIT
[0m11:22:26.817806 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:26.817806 [debug] [MainThread]: On master: COMMIT
[0m11:22:26.817806 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:22:26.817806 [debug] [MainThread]: On master: Close
[0m11:22:26.825021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:22:26.826072 [info ] [MainThread]: 
[0m11:22:26.831846 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:22:26.832881 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:22:26.833698 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:22:26.833698 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:22:26.842254 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:22:26.845338 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:22:26.833698 => 11:22:26.844696
[0m11:22:26.845454 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:22:26.877299 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:22:26.878419 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:26.879303 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:22:26.879612 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:22:26.883436 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:26.883436 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:26.883436 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:22:26.883436 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:26.896028 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:26.897134 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:22:26.897909 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:26.901056 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:26.901926 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:22:26.901926 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:26.917310 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:22:26.917310 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:26.923590 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:22:26.929972 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:26.933808 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:26.933808 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:22:26.933808 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:26.933808 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:22:26.845454 => 11:22:26.933808
[0m11:22:26.933808 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:22:26.948899 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1963e0-8cfa-4f6f-b6fd-8ece558088d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A9EA23D0>]}
[0m11:22:26.949901 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.12s]
[0m11:22:26.953152 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:22:26.954149 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:22:26.955149 [info ] [Thread-1 (]: 2 of 3 START sql table model main.test ......................................... [RUN]
[0m11:22:26.957765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:22:26.960919 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:22:26.966827 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:22:26.966827 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:22:26.961611 => 11:22:26.966827
[0m11:22:26.966827 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:22:26.974278 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:22:26.974278 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:26.974278 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:22:26.974278 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:26.994381 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:26.994381 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:26.994381 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      


SELECT *
FROM 'data/studentInfo.csv'
WHERE disability = 'Y'
    );
  
  
[0m11:22:27.070648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:27.072643 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:27.073540 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter table "dev"."main"."test" rename to "test__dbt_backup"
[0m11:22:27.074540 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:27.078403 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:27.078403 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter table "dev"."main"."test__dbt_tmp" rename to "test"
[0m11:22:27.079460 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:27.081534 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:22:27.081534 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:27.082533 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:22:27.086248 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:27.088363 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:27.089359 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_backup" cascade
[0m11:22:27.091312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:27.092253 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:22:26.966827 => 11:22:27.092253
[0m11:22:27.093252 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:22:27.111190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1963e0-8cfa-4f6f-b6fd-8ece558088d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A9E60750>]}
[0m11:22:27.112229 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.test .................................... [[32mOK[0m in 0.15s]
[0m11:22:27.113237 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:22:27.113237 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:22:27.114229 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:22:27.114536 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:22:27.115583 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:22:27.116597 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:22:27.117634 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:22:27.115583 => 11:22:27.117634
[0m11:22:27.118591 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:22:27.130797 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:22:27.131799 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:27.132742 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:22:27.132742 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:27.144045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:27.145058 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:27.145058 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:22:27.146043 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:27.147430 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:27.147430 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:22:27.147430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:27.147430 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:27.147430 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:22:27.147430 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:27.147430 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:22:27.147430 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:27.147430 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:22:27.158899 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:27.159272 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:27.159272 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:22:27.159272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:27.159272 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:22:27.118591 => 11:22:27.159272
[0m11:22:27.159272 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:22:27.159272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee1963e0-8cfa-4f6f-b6fd-8ece558088d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A9F725D0>]}
[0m11:22:27.159272 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.04s]
[0m11:22:27.173409 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:22:27.176469 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:27.176469 [debug] [MainThread]: On master: BEGIN
[0m11:22:27.176469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:22:27.185865 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:22:27.186886 [debug] [MainThread]: On master: COMMIT
[0m11:22:27.186886 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:27.187869 [debug] [MainThread]: On master: COMMIT
[0m11:22:27.187869 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:22:27.187869 [debug] [MainThread]: On master: Close
[0m11:22:27.190284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:27.190284 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:22:27.191284 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:22:27.191284 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:22:27.191284 [info ] [MainThread]: 
[0m11:22:27.192356 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m11:22:27.192356 [debug] [MainThread]: Command end result
[0m11:22:27.199333 [info ] [MainThread]: 
[0m11:22:27.200283 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:22:27.200283 [info ] [MainThread]: 
[0m11:22:27.201296 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:22:27.201296 [debug] [MainThread]: Command `dbt run` succeeded at 11:22:27.201296 after 0.97 seconds
[0m11:22:27.202337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A388C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A3919C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A395EAD0>]}
[0m11:22:27.202337 [debug] [MainThread]: Flushing usage events
[0m11:22:54.522058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA400F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA4583190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA24758D0>]}


============================== 11:22:54.522058 | d44f1827-edb0-438b-9ada-eddf75043fa3 ==============================
[0m11:22:54.522058 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:22:54.522058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:22:54.679497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd44f1827-edb0-438b-9ada-eddf75043fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA400E6D0>]}
[0m11:22:54.734414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd44f1827-edb0-438b-9ada-eddf75043fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA45799D0>]}
[0m11:22:54.734414 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:22:54.742422 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:22:54.836103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:54.837100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:54.842081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd44f1827-edb0-438b-9ada-eddf75043fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA246EF90>]}
[0m11:22:54.848191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd44f1827-edb0-438b-9ada-eddf75043fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA4987210>]}
[0m11:22:54.848191 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:22:54.863818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd44f1827-edb0-438b-9ada-eddf75043fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA3F86B50>]}
[0m11:22:54.863818 [info ] [MainThread]: 
[0m11:22:54.863818 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:22:54.863818 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:22:54.863818 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:22:54.863818 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:22:54.863818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:54.879486 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:54.895102 [debug] [ThreadPool]: On list_dev: Close
[0m11:22:54.898663 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:22:54.899844 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:22:54.899844 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:22:54.899844 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:22:54.899844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:22:54.915228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:54.915228 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:22:54.915228 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:22:54.915228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:54.915228 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:22:54.915228 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:22:54.915228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:54.915228 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:22:54.915228 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:22:54.915228 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:22:54.915228 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:54.915228 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:22:54.915228 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:22:54.931828 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:22:54.932965 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:22:54.932965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:22:54.938826 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:54.939833 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:22:54.939833 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:22:54.964429 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:22:54.964429 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:22:54.964429 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:22:54.964429 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:22:54.964429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd44f1827-edb0-438b-9ada-eddf75043fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA48FC8D0>]}
[0m11:22:54.964429 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:54.964429 [debug] [MainThread]: On master: BEGIN
[0m11:22:54.964429 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:22:54.980055 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:22:54.980055 [debug] [MainThread]: On master: COMMIT
[0m11:22:54.980055 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:54.980055 [debug] [MainThread]: On master: COMMIT
[0m11:22:54.980055 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:22:54.980055 [debug] [MainThread]: On master: Close
[0m11:22:54.980055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:22:54.980055 [info ] [MainThread]: 
[0m11:22:54.980055 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:22:54.980055 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:22:54.980055 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:22:54.980055 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:22:54.995680 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:22:54.995680 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:22:54.980055 => 11:22:54.995680
[0m11:22:54.995680 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:22:55.011305 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:22:55.011305 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:55.011305 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:22:55.011305 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:22:55.031212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.031212 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:55.031212 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:22:55.031212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.031212 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:55.031212 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:22:55.031212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.031212 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:55.031212 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:22:55.031212 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.048379 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:22:55.048379 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:55.048379 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:22:55.048379 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.067213 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:22:55.068271 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:22:55.070343 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.071479 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:22:54.995680 => 11:22:55.071479
[0m11:22:55.072477 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:22:55.081870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44f1827-edb0-438b-9ada-eddf75043fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA4C17210>]}
[0m11:22:55.081870 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m11:22:55.082826 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:22:55.083898 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:22:55.083898 [info ] [Thread-1 (]: 2 of 3 START sql table model main.test ......................................... [RUN]
[0m11:22:55.084875 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:22:55.084875 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:22:55.087949 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:22:55.088889 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:22:55.085933 => 11:22:55.087949
[0m11:22:55.088889 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:22:55.092912 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:22:55.093893 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:55.093893 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:22:55.094830 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:55.098320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.098320 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:55.098320 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      


SELECT *
FROM 'data/studentInfo.csv'
WHERE disability = 'Y'
    );
  
  
[0m11:22:55.181488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.181488 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:55.181488 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter table "dev"."main"."test" rename to "test__dbt_backup"
[0m11:22:55.181488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.181488 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:55.181488 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter table "dev"."main"."test__dbt_tmp" rename to "test"
[0m11:22:55.181488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.181488 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:22:55.181488 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:55.181488 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:22:55.198094 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.198810 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:22:55.198810 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_backup" cascade
[0m11:22:55.198810 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.198810 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:22:55.088889 => 11:22:55.198810
[0m11:22:55.198810 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:22:55.227513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44f1827-edb0-438b-9ada-eddf75043fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA49CE210>]}
[0m11:22:55.227513 [info ] [Thread-1 (]: 2 of 3 OK created sql table model main.test .................................... [[32mOK[0m in 0.13s]
[0m11:22:55.227513 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:22:55.227513 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:22:55.231050 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:22:55.232055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:22:55.232903 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:22:55.234325 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:22:55.234325 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:22:55.232903 => 11:22:55.234325
[0m11:22:55.234325 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:22:55.243468 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:22:55.243468 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:55.249346 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:22:55.249884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:22:55.259394 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.259394 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:55.260648 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:22:55.261397 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.265904 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:55.265904 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:22:55.265904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.265904 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:55.265904 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:22:55.265904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.265904 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:22:55.265904 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:55.265904 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:22:55.265904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.265904 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:22:55.265904 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:22:55.280567 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:22:55.283555 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:22:55.234325 => 11:22:55.283555
[0m11:22:55.283555 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:22:55.294161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44f1827-edb0-438b-9ada-eddf75043fa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013BA4DBC350>]}
[0m11:22:55.294161 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m11:22:55.297252 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:22:55.300498 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:55.301520 [debug] [MainThread]: On master: BEGIN
[0m11:22:55.302537 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:22:55.311524 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:22:55.311524 [debug] [MainThread]: On master: COMMIT
[0m11:22:55.312645 [debug] [MainThread]: Using duckdb connection "master"
[0m11:22:55.312645 [debug] [MainThread]: On master: COMMIT
[0m11:22:55.314015 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:22:55.314080 [debug] [MainThread]: On master: Close
[0m11:22:55.317270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:22:55.317270 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:22:55.317270 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:22:55.318357 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:22:55.318357 [info ] [MainThread]: 
[0m11:22:55.319330 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m11:22:55.319789 [debug] [MainThread]: Command end result
[0m11:22:55.326796 [info ] [MainThread]: 
[0m11:22:55.327797 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:22:55.328796 [info ] [MainThread]: 
[0m11:22:55.328796 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:22:55.331846 [debug] [MainThread]: Command `dbt run` succeeded at 11:22:55.331038 after 0.85 seconds
[0m11:22:55.332303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B9E88C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B9EB18D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013B9E95EB10>]}
[0m11:22:55.332303 [debug] [MainThread]: Flushing usage events
[0m11:23:14.711194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712A50810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71250E550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71250E710>]}


============================== 11:23:14.711194 | dafc1860-ca15-4c15-80fc-4eda3b83bda3 ==============================
[0m11:23:14.711194 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:23:14.711194 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:23:14.878438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dafc1860-ca15-4c15-80fc-4eda3b83bda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71097D010>]}
[0m11:23:14.925213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dafc1860-ca15-4c15-80fc-4eda3b83bda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712A7AD50>]}
[0m11:23:14.925213 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:23:14.925213 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:23:14.997554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:23:14.997554 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:23:15.077545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dafc1860-ca15-4c15-80fc-4eda3b83bda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712F47450>]}
[0m11:23:15.093170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dafc1860-ca15-4c15-80fc-4eda3b83bda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712FF0050>]}
[0m11:23:15.093170 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:23:15.093170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dafc1860-ca15-4c15-80fc-4eda3b83bda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712E6C6D0>]}
[0m11:23:15.093170 [info ] [MainThread]: 
[0m11:23:15.093170 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:23:15.093170 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:23:15.113675 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:23:15.113856 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:23:15.113856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:15.113856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:15.113856 [debug] [ThreadPool]: On list_dev: Close
[0m11:23:15.128986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:23:15.128986 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:23:15.128986 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:23:15.128986 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:23:15.128986 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:15.128986 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:15.144597 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:23:15.145598 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:23:15.145598 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:15.145598 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:23:15.145598 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:23:15.145598 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:15.145598 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:23:15.145598 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:23:15.145598 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:23:15.145598 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:15.145598 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:23:15.145598 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:23:15.145598 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:23:15.145598 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:23:15.145598 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:15.162838 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:15.162838 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:23:15.162838 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:23:15.196230 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:23:15.196230 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:23:15.196230 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:23:15.196230 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:23:15.196230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dafc1860-ca15-4c15-80fc-4eda3b83bda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712FDFB50>]}
[0m11:23:15.196230 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:15.196230 [debug] [MainThread]: On master: BEGIN
[0m11:23:15.196230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:23:15.215069 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:15.216067 [debug] [MainThread]: On master: COMMIT
[0m11:23:15.216067 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:15.217098 [debug] [MainThread]: On master: COMMIT
[0m11:23:15.217098 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:15.217098 [debug] [MainThread]: On master: Close
[0m11:23:15.219068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:15.220270 [info ] [MainThread]: 
[0m11:23:15.222395 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:23:15.223425 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:23:15.223425 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:23:15.224381 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:23:15.230698 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:23:15.232693 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:23:15.224381 => 11:23:15.231695
[0m11:23:15.233278 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:23:15.248413 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:23:15.261734 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:23:15.262880 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:23:15.262880 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:23:15.266894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.266894 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:23:15.266894 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:23:15.266894 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.278388 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:23:15.279480 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:23:15.280437 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.281113 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:23:15.281113 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:23:15.281113 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.299485 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:23:15.299485 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:23:15.299485 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:23:15.299485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.315012 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:23:15.316007 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:23:15.317954 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.319004 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:23:15.233278 => 11:23:15.319004
[0m11:23:15.320005 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:23:15.329964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dafc1860-ca15-4c15-80fc-4eda3b83bda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E7132DD610>]}
[0m11:23:15.332968 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.11s]
[0m11:23:15.334003 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:23:15.336216 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:23:15.338575 [info ] [Thread-1 (]: 2 of 3 START sql external model main.test ...................................... [RUN]
[0m11:23:15.342402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:23:15.342402 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:23:15.348958 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:23:15.348958 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:23:15.343400 => 11:23:15.348958
[0m11:23:15.354406 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:23:15.367686 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:23:15.367686 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:23:15.367686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:15.385342 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.385342 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:23:15.394920 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      


SELECT *
FROM 'data/studentInfo.csv'
WHERE disability = 'Y'
    );
  
  
[0m11:23:15.463312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.463312 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:23:15.463312 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
copy "dev"."main"."test__dbt_tmp" to 'output/test.csv' (format csv, header 1)
[0m11:23:15.463312 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.473220 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:23:15.473220 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:23:15.473220 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
create or replace view "dev"."main"."test__dbt_int" as (
        select * from 'output/test.csv'
    );
[0m11:23:15.510319 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.511104 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:23:15.511104 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter table "dev"."main"."test" rename to "test__dbt_backup"
[0m11:23:15.511104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.511104 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:23:15.511104 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test__dbt_int" rename to "test"
[0m11:23:15.511104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.511104 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:23:15.511104 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:23:15.511104 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:23:15.511104 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.511104 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:23:15.511104 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_backup" cascade
[0m11:23:15.526760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.526760 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:23:15.526760 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_tmp" cascade
[0m11:23:15.526760 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.526760 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:23:15.354406 => 11:23:15.526760
[0m11:23:15.526760 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:23:15.537562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dafc1860-ca15-4c15-80fc-4eda3b83bda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E712F17D90>]}
[0m11:23:15.537562 [info ] [Thread-1 (]: 2 of 3 OK created sql external model main.test ................................. [[32mOK[0m in 0.20s]
[0m11:23:15.539313 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:23:15.539313 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:23:15.539313 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:23:15.540820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:23:15.541929 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:23:15.542861 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:23:15.542861 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:23:15.541929 => 11:23:15.542861
[0m11:23:15.542861 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:23:15.546422 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:23:15.546422 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:23:15.546422 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:23:15.546422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:15.565153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.565153 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:23:15.565153 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:23:15.565153 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.565153 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:23:15.565153 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:23:15.577951 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.580001 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:23:15.580001 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:23:15.580001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.580001 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:23:15.580001 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:23:15.580001 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:23:15.580001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.580001 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:23:15.580001 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:23:15.580001 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:23:15.580001 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:23:15.542861 => 11:23:15.580001
[0m11:23:15.594087 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:23:15.601187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dafc1860-ca15-4c15-80fc-4eda3b83bda3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E71347EC10>]}
[0m11:23:15.601187 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m11:23:15.601187 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:23:15.601187 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:15.601187 [debug] [MainThread]: On master: BEGIN
[0m11:23:15.601187 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:23:15.615400 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:15.615400 [debug] [MainThread]: On master: COMMIT
[0m11:23:15.615400 [debug] [MainThread]: Using duckdb connection "master"
[0m11:23:15.615400 [debug] [MainThread]: On master: COMMIT
[0m11:23:15.615400 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:23:15.615400 [debug] [MainThread]: On master: Close
[0m11:23:15.615400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:15.615400 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:23:15.615400 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:23:15.615400 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:23:15.615400 [info ] [MainThread]: 
[0m11:23:15.615400 [info ] [MainThread]: Finished running 1 table model, 1 external model, 1 view model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m11:23:15.615400 [debug] [MainThread]: Command end result
[0m11:23:15.628920 [info ] [MainThread]: 
[0m11:23:15.628920 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:15.628920 [info ] [MainThread]: 
[0m11:23:15.628920 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:23:15.628920 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:15.628920 after 0.97 seconds
[0m11:23:15.628920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70CD8C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70CE19C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E70CE5EAD0>]}
[0m11:23:15.628920 [debug] [MainThread]: Flushing usage events
[0m11:29:33.001890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B63678290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B636839D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B63682B10>]}


============================== 11:29:33.005894 | fba03fec-b3e2-4828-a9cf-a4eb728a2ce6 ==============================
[0m11:29:33.005894 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:29:33.007833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:29:33.203736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fba03fec-b3e2-4828-a9cf-a4eb728a2ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B636E0750>]}
[0m11:29:33.277679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fba03fec-b3e2-4828-a9cf-a4eb728a2ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B62E47750>]}
[0m11:29:33.279647 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:29:33.291290 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:29:33.368740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:29:33.369739 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:29:33.466161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fba03fec-b3e2-4828-a9cf-a4eb728a2ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B63EE6410>]}
[0m11:29:33.476758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fba03fec-b3e2-4828-a9cf-a4eb728a2ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B63BF0410>]}
[0m11:29:33.476758 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:29:33.477859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba03fec-b3e2-4828-a9cf-a4eb728a2ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B63B31450>]}
[0m11:29:33.479897 [info ] [MainThread]: 
[0m11:29:33.479897 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:29:33.481361 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:29:33.489977 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:29:33.489977 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:29:33.490933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:33.500399 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:29:33.501578 [debug] [ThreadPool]: On list_dev: Close
[0m11:29:33.504592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:29:33.504592 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:29:33.510770 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:29:33.511258 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:29:33.512412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:29:33.522153 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:29:33.522153 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:29:33.526059 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:29:33.526059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:29:33.526059 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:29:33.526059 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:29:33.526059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:29:33.526059 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:29:33.526059 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:29:33.526059 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:29:33.526059 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:29:33.526059 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:29:33.531957 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:29:33.531957 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:29:33.531957 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:29:33.531957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:33.531957 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:29:33.546967 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:29:33.548003 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:29:33.574750 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:29:33.578849 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:29:33.579843 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:29:33.580764 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:29:33.581890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fba03fec-b3e2-4828-a9cf-a4eb728a2ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B637BECD0>]}
[0m11:29:33.581890 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:33.581890 [debug] [MainThread]: On master: BEGIN
[0m11:29:33.581890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:29:33.581890 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:29:33.581890 [debug] [MainThread]: On master: COMMIT
[0m11:29:33.581890 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:33.581890 [debug] [MainThread]: On master: COMMIT
[0m11:29:33.581890 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:29:33.581890 [debug] [MainThread]: On master: Close
[0m11:29:33.581890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:29:33.581890 [info ] [MainThread]: 
[0m11:29:33.597548 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:29:33.598609 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:29:33.599420 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:29:33.599420 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:29:33.599420 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:29:33.599420 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:29:33.599420 => 11:29:33.599420
[0m11:29:33.599420 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:29:33.629418 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:29:33.633062 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:29:33.633062 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:29:33.634110 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:29:33.640114 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.641141 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:29:33.641141 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:29:33.642121 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.646200 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:29:33.647199 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:29:33.647199 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.648265 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:29:33.648265 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:29:33.648265 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.665814 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:29:33.665814 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:29:33.665814 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:29:33.665814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.665814 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:29:33.665814 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:29:33.665814 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.665814 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:29:33.599420 => 11:29:33.665814
[0m11:29:33.665814 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:29:33.686008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fba03fec-b3e2-4828-a9cf-a4eb728a2ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B63F5B890>]}
[0m11:29:33.686008 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m11:29:33.686895 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:29:33.687895 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:29:33.687895 [info ] [Thread-1 (]: 2 of 3 START sql external model main.test ...................................... [RUN]
[0m11:29:33.688961 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:29:33.688961 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:29:33.691018 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:29:33.692011 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:29:33.688961 => 11:29:33.692011
[0m11:29:33.692897 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:29:33.712298 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:29:33.712298 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:29:33.712298 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:33.720210 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.720210 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:29:33.720210 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      


SELECT region, final_result
FROM 'data/studentInfo.csv'
WHERE studied_credits = 225
    );
  
  
[0m11:29:33.782387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.782387 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:29:33.782387 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
copy "dev"."main"."test__dbt_tmp" to 'output/test.csv' (format csv, header 1)
[0m11:29:33.782387 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.782387 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:29:33.796927 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:29:33.797527 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
create or replace view "dev"."main"."test__dbt_int" as (
        select * from 'output/test.csv'
    );
[0m11:29:33.797878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.797878 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:29:33.797878 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test" rename to "test__dbt_backup"
[0m11:29:33.797878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.797878 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:29:33.797878 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test__dbt_int" rename to "test"
[0m11:29:33.797878 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.815501 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:29:33.815675 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:29:33.815675 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:29:33.818226 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.819115 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:29:33.819115 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop view if exists "dev"."main"."test__dbt_backup" cascade
[0m11:29:33.819115 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.819115 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:29:33.819115 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_tmp" cascade
[0m11:29:33.826361 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.826361 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:29:33.692897 => 11:29:33.826361
[0m11:29:33.826361 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:29:33.833449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fba03fec-b3e2-4828-a9cf-a4eb728a2ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B63E14950>]}
[0m11:29:33.834439 [info ] [Thread-1 (]: 2 of 3 OK created sql external model main.test ................................. [[32mOK[0m in 0.14s]
[0m11:29:33.834439 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:29:33.834439 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:29:33.834439 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:29:33.834439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:29:33.834439 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:29:33.834439 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:29:33.834439 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:29:33.834439 => 11:29:33.834439
[0m11:29:33.834439 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:29:33.850401 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:29:33.850401 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:29:33.856831 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:29:33.856831 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:33.868438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.868438 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:29:33.868438 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:29:33.868438 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.871184 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:29:33.871184 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:29:33.871184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.876694 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:29:33.876694 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:29:33.876694 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.876694 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:29:33.880785 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:29:33.881856 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:29:33.884866 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.884866 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:29:33.884866 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:29:33.889983 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:29:33.889983 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:29:33.834439 => 11:29:33.889983
[0m11:29:33.889983 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:29:33.897443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fba03fec-b3e2-4828-a9cf-a4eb728a2ce6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6427AB50>]}
[0m11:29:33.898863 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m11:29:33.899782 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:29:33.902643 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:33.903779 [debug] [MainThread]: On master: BEGIN
[0m11:29:33.903779 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:29:33.919308 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:29:33.919308 [debug] [MainThread]: On master: COMMIT
[0m11:29:33.919308 [debug] [MainThread]: Using duckdb connection "master"
[0m11:29:33.919308 [debug] [MainThread]: On master: COMMIT
[0m11:29:33.921546 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:29:33.921546 [debug] [MainThread]: On master: Close
[0m11:29:33.923714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:33.923714 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:29:33.923714 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:29:33.923714 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:29:33.923714 [info ] [MainThread]: 
[0m11:29:33.927430 [info ] [MainThread]: Finished running 1 table model, 1 external model, 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m11:29:33.927430 [debug] [MainThread]: Command end result
[0m11:29:33.935040 [info ] [MainThread]: 
[0m11:29:33.935040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:29:33.935040 [info ] [MainThread]: 
[0m11:29:33.935040 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:29:33.940716 [debug] [MainThread]: Command `dbt run` succeeded at 11:29:33.940716 after 1.02 seconds
[0m11:29:33.940716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B6347C0D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B5D98C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019B5DA19C10>]}
[0m11:29:33.940716 [debug] [MainThread]: Flushing usage events
[0m11:30:16.527678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08E7302D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08E732510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08E732550>]}


============================== 11:30:16.527678 | 9fd55a0c-3734-48e9-8633-b08aa2607ad1 ==============================
[0m11:30:16.527678 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:30:16.527678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:30:16.694763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fd55a0c-3734-48e9-8633-b08aa2607ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08EAD0750>]}
[0m11:30:16.759195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fd55a0c-3734-48e9-8633-b08aa2607ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08EB3BD50>]}
[0m11:30:16.774247 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:30:16.774247 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:30:16.843168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:30:16.843168 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:30:16.941721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fd55a0c-3734-48e9-8633-b08aa2607ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08EF0AD50>]}
[0m11:30:16.959060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fd55a0c-3734-48e9-8633-b08aa2607ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08EEF43D0>]}
[0m11:30:16.959060 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:30:16.959060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd55a0c-3734-48e9-8633-b08aa2607ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08EAA1F10>]}
[0m11:30:16.959060 [info ] [MainThread]: 
[0m11:30:16.959060 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:30:16.959060 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:30:16.975829 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:30:16.975829 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:30:16.975829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:16.993354 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:16.995281 [debug] [ThreadPool]: On list_dev: Close
[0m11:30:16.995281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:30:16.995281 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:30:16.995281 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:30:16.995281 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:30:17.007100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:17.011033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:17.011033 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:30:17.011033 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:30:17.011033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:17.011033 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:30:17.011033 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:30:17.011033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:17.011033 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:30:17.011033 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:30:17.011033 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:30:17.011033 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:17.011033 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:30:17.025558 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:30:17.029149 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:30:17.029149 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:30:17.029149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:17.029149 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:17.029149 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:30:17.029149 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:30:17.059810 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:30:17.059810 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:30:17.059810 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:30:17.059810 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:30:17.074487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd55a0c-3734-48e9-8633-b08aa2607ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08EB119D0>]}
[0m11:30:17.074487 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:17.074487 [debug] [MainThread]: On master: BEGIN
[0m11:30:17.074487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:17.074487 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:17.074487 [debug] [MainThread]: On master: COMMIT
[0m11:30:17.074487 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:17.074487 [debug] [MainThread]: On master: COMMIT
[0m11:30:17.074487 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:17.074487 [debug] [MainThread]: On master: Close
[0m11:30:17.074487 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:30:17.074487 [info ] [MainThread]: 
[0m11:30:17.091160 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:30:17.091160 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:30:17.091160 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:30:17.091160 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:30:17.091160 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:30:17.091160 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:30:17.091160 => 11:30:17.091160
[0m11:30:17.091160 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:30:17.129045 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:30:17.129045 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:30:17.129045 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:30:17.129045 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:30:17.129045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.129045 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:30:17.129045 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:30:17.129045 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.143219 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:30:17.143219 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:30:17.143219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.143219 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:30:17.143219 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:30:17.143219 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.159027 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:30:17.159027 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:30:17.159027 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:30:17.159027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.159027 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:30:17.159027 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:30:17.174168 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.174168 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:30:17.091160 => 11:30:17.174168
[0m11:30:17.174168 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:30:17.174168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd55a0c-3734-48e9-8633-b08aa2607ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08EE30190>]}
[0m11:30:17.174168 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m11:30:17.174168 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:30:17.174168 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:30:17.174168 [info ] [Thread-1 (]: 2 of 3 START sql external model main.test ...................................... [RUN]
[0m11:30:17.174168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:30:17.174168 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:30:17.190755 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:30:17.190755 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:30:17.174168 => 11:30:17.190755
[0m11:30:17.190755 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:30:17.211413 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:30:17.211413 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:30:17.211413 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:17.229619 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.229619 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:30:17.229619 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      


SELECT region, final_result
FROM 'data/studentInfo.csv'
    );
  
  
[0m11:30:17.306729 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.307658 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:30:17.307658 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
copy "dev"."main"."test__dbt_tmp" to 'output/test.csv' (format csv, header 1)
[0m11:30:17.307658 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.307658 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:30:17.307658 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:30:17.307658 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
create or replace view "dev"."main"."test__dbt_int" as (
        select * from 'output/test.csv'
    );
[0m11:30:17.341457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.341457 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:30:17.341457 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test" rename to "test__dbt_backup"
[0m11:30:17.341457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.341457 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:30:17.341457 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test__dbt_int" rename to "test"
[0m11:30:17.341457 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.341457 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:30:17.341457 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:30:17.341457 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:30:17.357400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.357400 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:30:17.357400 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop view if exists "dev"."main"."test__dbt_backup" cascade
[0m11:30:17.357400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.357400 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:30:17.357400 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_tmp" cascade
[0m11:30:17.357400 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.357400 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:30:17.190755 => 11:30:17.357400
[0m11:30:17.357400 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:30:17.374349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd55a0c-3734-48e9-8633-b08aa2607ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08F0EEC10>]}
[0m11:30:17.374349 [info ] [Thread-1 (]: 2 of 3 OK created sql external model main.test ................................. [[32mOK[0m in 0.20s]
[0m11:30:17.374349 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:30:17.374349 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:30:17.374349 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:30:17.374349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:30:17.374349 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:30:17.374349 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:30:17.374349 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:30:17.374349 => 11:30:17.374349
[0m11:30:17.374349 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:30:17.390946 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:30:17.390946 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:30:17.390946 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:30:17.390946 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:17.407740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.407740 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:30:17.407740 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:30:17.407740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.407740 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:30:17.407740 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:30:17.407740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.407740 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:30:17.407740 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:30:17.407740 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.423510 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:30:17.424475 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:30:17.424475 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:30:17.424475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.424475 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:30:17.424475 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:30:17.424475 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:30:17.424475 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:30:17.374349 => 11:30:17.424475
[0m11:30:17.424475 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:30:17.441019 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fd55a0c-3734-48e9-8633-b08aa2607ad1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08EBD58D0>]}
[0m11:30:17.441019 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m11:30:17.441019 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:30:17.441019 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:17.441019 [debug] [MainThread]: On master: BEGIN
[0m11:30:17.441019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:17.441019 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:17.456829 [debug] [MainThread]: On master: COMMIT
[0m11:30:17.458040 [debug] [MainThread]: Using duckdb connection "master"
[0m11:30:17.458040 [debug] [MainThread]: On master: COMMIT
[0m11:30:17.458040 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:30:17.458040 [debug] [MainThread]: On master: Close
[0m11:30:17.458040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:17.458040 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:30:17.458040 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:30:17.458040 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:30:17.458040 [info ] [MainThread]: 
[0m11:30:17.458040 [info ] [MainThread]: Finished running 1 table model, 1 external model, 1 view model in 0 hours 0 minutes and 0.50 seconds (0.50s).
[0m11:30:17.458040 [debug] [MainThread]: Command end result
[0m11:30:17.474552 [info ] [MainThread]: 
[0m11:30:17.474552 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:30:17.474552 [info ] [MainThread]: 
[0m11:30:17.474552 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:30:17.474552 [debug] [MainThread]: Command `dbt run` succeeded at 11:30:17.474552 after 1.00 seconds
[0m11:30:17.474552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E08E77AE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E088A8C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E088D18D50>]}
[0m11:30:17.474552 [debug] [MainThread]: Flushing usage events
[0m11:31:12.072491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69B247110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69C70EE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69CC83150>]}


============================== 11:31:12.072491 | ecba98b9-646d-4704-8ba5-45d241f8e260 ==============================
[0m11:31:12.072491 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:31:12.072491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:31:12.236597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ecba98b9-646d-4704-8ba5-45d241f8e260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69CCCAAD0>]}
[0m11:31:12.283365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ecba98b9-646d-4704-8ba5-45d241f8e260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69CC88B90>]}
[0m11:31:12.283365 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:31:12.299094 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:31:12.358328 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:31:12.359287 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:31:12.436341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecba98b9-646d-4704-8ba5-45d241f8e260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69CCCAAD0>]}
[0m11:31:12.451865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ecba98b9-646d-4704-8ba5-45d241f8e260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69D1EB350>]}
[0m11:31:12.451865 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:31:12.451865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecba98b9-646d-4704-8ba5-45d241f8e260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69D06C550>]}
[0m11:31:12.451865 [info ] [MainThread]: 
[0m11:31:12.451865 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:31:12.451865 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:31:12.467597 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:31:12.467597 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:31:12.467597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:12.467597 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:12.467597 [debug] [ThreadPool]: On list_dev: Close
[0m11:31:12.467597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:31:12.467597 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:31:12.486805 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:31:12.487509 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:31:12.488730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:12.489136 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:12.489136 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:31:12.489136 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:31:12.489136 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:12.489136 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:31:12.489136 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:31:12.489136 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:12.489136 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:31:12.489136 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:31:12.489136 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:31:12.489136 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:12.489136 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:31:12.489136 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:31:12.508207 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:31:12.509208 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:31:12.509208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:12.515207 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:12.516208 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:31:12.516208 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:31:12.539741 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:12.544682 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:31:12.545748 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:31:12.545748 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:31:12.548868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ecba98b9-646d-4704-8ba5-45d241f8e260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69D170610>]}
[0m11:31:12.548868 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:12.549921 [debug] [MainThread]: On master: BEGIN
[0m11:31:12.549921 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:12.555885 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:31:12.555885 [debug] [MainThread]: On master: COMMIT
[0m11:31:12.555885 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:12.555885 [debug] [MainThread]: On master: COMMIT
[0m11:31:12.555885 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:31:12.555885 [debug] [MainThread]: On master: Close
[0m11:31:12.555885 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:31:12.555885 [info ] [MainThread]: 
[0m11:31:12.555885 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:31:12.555885 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:31:12.555885 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:31:12.555885 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:31:12.555885 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:31:12.555885 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:31:12.555885 => 11:31:12.555885
[0m11:31:12.555885 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:31:12.592314 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:31:12.592314 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:12.592314 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:31:12.592314 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:31:12.592314 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.592314 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:12.592314 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:31:12.592314 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.608875 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:12.608875 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:31:12.608875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.608875 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:12.608875 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:31:12.608875 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.623919 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:31:12.623919 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:12.623919 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:31:12.623919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.623919 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:12.623919 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:31:12.640834 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.640834 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:31:12.571850 => 11:31:12.640834
[0m11:31:12.640834 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:31:12.640834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecba98b9-646d-4704-8ba5-45d241f8e260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69D42CB10>]}
[0m11:31:12.640834 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m11:31:12.640834 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:31:12.640834 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:31:12.640834 [info ] [Thread-1 (]: 2 of 3 START sql external model main.test ...................................... [RUN]
[0m11:31:12.655837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:31:12.655837 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:31:12.657824 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:31:12.658825 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:31:12.655837 => 11:31:12.658825
[0m11:31:12.659805 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:31:12.674974 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:31:12.674974 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:31:12.674974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:12.689259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.689259 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:31:12.689259 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      


SELECT region, final_result
FROM 'data/studentInfo.csv'
WHERE final_result = Pass
    );
  
  
[0m11:31:12.720650 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:31:12.659805 => 11:31:12.720650
[0m11:31:12.721619 [debug] [Thread-1 (]: On model.assignment1.test: ROLLBACK
[0m11:31:12.722375 [debug] [Thread-1 (]: Failed to rollback 'model.assignment1.test'
[0m11:31:12.722375 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:31:12.722375 [debug] [Thread-1 (]: Runtime Error in model test (models\test\test.sql)
  Binder Error: Referenced column "Pass" not found in FROM clause!
  Candidate bindings: "studentInfo.gender"
  LINE 16: WHERE final_result = Pass
                                ^
[0m11:31:12.722375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecba98b9-646d-4704-8ba5-45d241f8e260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69D594E90>]}
[0m11:31:12.722375 [error] [Thread-1 (]: 2 of 3 ERROR creating sql external model main.test ............................. [[31mERROR[0m in 0.07s]
[0m11:31:12.722375 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:31:12.722375 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:31:12.722375 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:31:12.722375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:31:12.722375 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:31:12.722375 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:31:12.722375 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:31:12.722375 => 11:31:12.722375
[0m11:31:12.737381 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:31:12.739198 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:31:12.739198 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:12.739198 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:31:12.739198 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:12.759004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.759004 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:12.759004 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:31:12.759004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.759004 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:12.759004 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:31:12.759004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.759004 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:12.759004 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:31:12.759004 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.759004 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:31:12.759004 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:12.759004 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:31:12.771571 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.774578 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:12.774578 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:31:12.775647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:12.775647 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:31:12.738198 => 11:31:12.775647
[0m11:31:12.775647 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:31:12.775647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecba98b9-646d-4704-8ba5-45d241f8e260', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69D594A90>]}
[0m11:31:12.775647 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m11:31:12.775647 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:31:12.789254 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:12.789254 [debug] [MainThread]: On master: BEGIN
[0m11:31:12.790457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:31:12.806769 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:31:12.806769 [debug] [MainThread]: On master: COMMIT
[0m11:31:12.806769 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:12.806769 [debug] [MainThread]: On master: COMMIT
[0m11:31:12.806769 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:31:12.806769 [debug] [MainThread]: On master: Close
[0m11:31:12.806769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:12.806769 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:31:12.806769 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:31:12.806769 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:31:12.806769 [info ] [MainThread]: 
[0m11:31:12.806769 [info ] [MainThread]: Finished running 1 table model, 1 external model, 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:31:12.806769 [debug] [MainThread]: Command end result
[0m11:31:12.821368 [info ] [MainThread]: 
[0m11:31:12.822376 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:31:12.823376 [info ] [MainThread]: 
[0m11:31:12.823376 [error] [MainThread]:   Runtime Error in model test (models\test\test.sql)
  Binder Error: Referenced column "Pass" not found in FROM clause!
  Candidate bindings: "studentInfo.gender"
  LINE 16: WHERE final_result = Pass
                                ^
[0m11:31:12.825078 [info ] [MainThread]: 
[0m11:31:12.825078 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:31:12.825078 [debug] [MainThread]: Command `dbt run` failed at 11:31:12.825078 after 0.82 seconds
[0m11:31:12.825078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C696F8C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69705F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C69705EB50>]}
[0m11:31:12.825078 [debug] [MainThread]: Flushing usage events
[0m11:31:23.684220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97F34C4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97ED86D50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97D5FE010>]}


============================== 11:31:23.684220 | 6c4227b5-cd80-4409-af27-2d420abfc063 ==============================
[0m11:31:23.684220 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:31:23.699846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:31:23.869323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c4227b5-cd80-4409-af27-2d420abfc063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97F37AC50>]}
[0m11:31:23.933995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c4227b5-cd80-4409-af27-2d420abfc063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97F6918D0>]}
[0m11:31:23.934994 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:31:23.941842 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:31:24.013572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:31:24.013572 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:31:24.115568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c4227b5-cd80-4409-af27-2d420abfc063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97FAB2610>]}
[0m11:31:24.128449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c4227b5-cd80-4409-af27-2d420abfc063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97FAF40D0>]}
[0m11:31:24.128449 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:31:24.128449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c4227b5-cd80-4409-af27-2d420abfc063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97F3CE210>]}
[0m11:31:24.128449 [info ] [MainThread]: 
[0m11:31:24.128449 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:31:24.128449 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:31:24.145622 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:31:24.145622 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:31:24.145622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:24.145622 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:24.145622 [debug] [ThreadPool]: On list_dev: Close
[0m11:31:24.162752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:31:24.163752 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:31:24.165262 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:31:24.165262 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:31:24.165262 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:31:24.165262 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:24.178408 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:31:24.178408 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:31:24.179407 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:24.179407 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:31:24.179407 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:31:24.180407 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:24.181828 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:31:24.181828 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:31:24.181828 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:31:24.181828 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:24.181828 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:31:24.181828 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:31:24.181828 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:31:24.181828 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:31:24.181828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:31:24.196389 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:24.196389 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:31:24.196389 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:31:24.227783 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:31:24.227783 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:31:24.227783 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:31:24.227783 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:31:24.227783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c4227b5-cd80-4409-af27-2d420abfc063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97FC26390>]}
[0m11:31:24.227783 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:24.227783 [debug] [MainThread]: On master: BEGIN
[0m11:31:24.227783 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:31:24.247683 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:31:24.247683 [debug] [MainThread]: On master: COMMIT
[0m11:31:24.247683 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:24.247683 [debug] [MainThread]: On master: COMMIT
[0m11:31:24.247683 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:31:24.247683 [debug] [MainThread]: On master: Close
[0m11:31:24.247683 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:31:24.247683 [info ] [MainThread]: 
[0m11:31:24.247683 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:31:24.247683 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:31:24.247683 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:31:24.247683 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:31:24.261520 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:31:24.261520 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:31:24.247683 => 11:31:24.261520
[0m11:31:24.261520 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:31:24.295019 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:31:24.296263 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:24.296263 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:31:24.296263 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:31:24.296263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.296263 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:24.296263 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:31:24.296263 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.312733 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:24.312733 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:31:24.312733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.312733 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:24.312733 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:31:24.312733 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.332644 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:31:24.332644 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:24.332644 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:31:24.332644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.332644 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:31:24.332644 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:31:24.344020 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.346030 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:31:24.261520 => 11:31:24.346030
[0m11:31:24.346030 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:31:24.346030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4227b5-cd80-4409-af27-2d420abfc063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97FCD9C10>]}
[0m11:31:24.346030 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m11:31:24.346030 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:31:24.346030 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:31:24.346030 [info ] [Thread-1 (]: 2 of 3 START sql external model main.test ...................................... [RUN]
[0m11:31:24.346030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:31:24.346030 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:31:24.346030 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:31:24.360649 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:31:24.346030 => 11:31:24.360649
[0m11:31:24.361656 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:31:24.380311 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:31:24.381490 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:31:24.381490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:24.396272 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.396272 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:31:24.396272 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      


SELECT region, final_result
FROM 'data/studentInfo.csv'
WHERE final_result = "Pass"
    );
  
  
[0m11:31:24.427224 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:31:24.362265 => 11:31:24.427224
[0m11:31:24.428242 [debug] [Thread-1 (]: On model.assignment1.test: ROLLBACK
[0m11:31:24.429604 [debug] [Thread-1 (]: Failed to rollback 'model.assignment1.test'
[0m11:31:24.429604 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:31:24.429604 [debug] [Thread-1 (]: Runtime Error in model test (models\test\test.sql)
  Binder Error: Referenced column "Pass" not found in FROM clause!
  Candidate bindings: "studentInfo.gender"
  LINE 16: WHERE final_result = "Pass"
                                ^
[0m11:31:24.429604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4227b5-cd80-4409-af27-2d420abfc063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97FBF5750>]}
[0m11:31:24.429604 [error] [Thread-1 (]: 2 of 3 ERROR creating sql external model main.test ............................. [[31mERROR[0m in 0.08s]
[0m11:31:24.429604 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:31:24.429604 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:31:24.429604 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:31:24.429604 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:31:24.429604 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:31:24.429604 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:31:24.443956 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:31:24.429604 => 11:31:24.443956
[0m11:31:24.443956 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:31:24.446445 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:31:24.460415 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:24.461424 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:31:24.461424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:31:24.464615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.464615 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:24.464615 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:31:24.464615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.464615 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:24.464615 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:31:24.464615 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.464615 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:24.464615 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:31:24.477084 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.478091 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:31:24.479091 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:24.479559 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:31:24.479559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.479559 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:31:24.479559 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:31:24.479559 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:31:24.479559 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:31:24.444962 => 11:31:24.479559
[0m11:31:24.479559 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:31:24.493757 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4227b5-cd80-4409-af27-2d420abfc063', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97FADD250>]}
[0m11:31:24.494765 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m11:31:24.495764 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:31:24.497488 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:24.497488 [debug] [MainThread]: On master: BEGIN
[0m11:31:24.497488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:31:24.497488 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:31:24.497488 [debug] [MainThread]: On master: COMMIT
[0m11:31:24.497488 [debug] [MainThread]: Using duckdb connection "master"
[0m11:31:24.497488 [debug] [MainThread]: On master: COMMIT
[0m11:31:24.510427 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:31:24.511436 [debug] [MainThread]: On master: Close
[0m11:31:24.513427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:31:24.513427 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:31:24.513427 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:31:24.513427 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:31:24.513427 [info ] [MainThread]: 
[0m11:31:24.513427 [info ] [MainThread]: Finished running 1 table model, 1 external model, 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m11:31:24.513427 [debug] [MainThread]: Command end result
[0m11:31:24.524812 [info ] [MainThread]: 
[0m11:31:24.527070 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:31:24.528078 [info ] [MainThread]: 
[0m11:31:24.529076 [error] [MainThread]:   Runtime Error in model test (models\test\test.sql)
  Binder Error: Referenced column "Pass" not found in FROM clause!
  Candidate bindings: "studentInfo.gender"
  LINE 16: WHERE final_result = "Pass"
                                ^
[0m11:31:24.531077 [info ] [MainThread]: 
[0m11:31:24.531993 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:31:24.531993 [debug] [MainThread]: Command `dbt run` failed at 11:31:24.531993 after 0.89 seconds
[0m11:31:24.531993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97968C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97975F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B97975EB50>]}
[0m11:31:24.531993 [debug] [MainThread]: Flushing usage events
[0m11:33:35.422663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B02B650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B083710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B033D90>]}


============================== 11:33:35.424765 | fd9e8941-4954-4a98-9de7-83dff04395c5 ==============================
[0m11:33:35.424765 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:33:35.425770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:33:35.579325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd9e8941-4954-4a98-9de7-83dff04395c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B0E0750>]}
[0m11:33:35.639100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd9e8941-4954-4a98-9de7-83dff04395c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011A8499D0>]}
[0m11:33:35.640199 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:33:35.647209 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:33:35.717245 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:35.718439 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:33:35.814161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd9e8941-4954-4a98-9de7-83dff04395c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B8256D0>]}
[0m11:33:35.823275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd9e8941-4954-4a98-9de7-83dff04395c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B809450>]}
[0m11:33:35.824300 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:33:35.825277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd9e8941-4954-4a98-9de7-83dff04395c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B4702D0>]}
[0m11:33:35.826276 [info ] [MainThread]: 
[0m11:33:35.827277 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:33:35.828416 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:33:35.838444 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:33:35.838444 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:33:35.839441 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:35.847441 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:35.848441 [debug] [ThreadPool]: On list_dev: Close
[0m11:33:35.850817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:33:35.851856 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:33:35.857854 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:33:35.857854 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:33:35.858793 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:35.864991 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:35.866992 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:33:35.866992 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:33:35.866992 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:35.867990 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:33:35.867990 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:33:35.869112 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:35.870238 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:33:35.870238 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:33:35.871245 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:33:35.872248 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:35.872248 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:33:35.876247 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:33:35.880502 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:33:35.880502 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:33:35.881478 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:35.887478 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:35.888478 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:33:35.889480 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:33:35.916006 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:35.921224 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:33:35.922248 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:33:35.922248 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:33:35.925249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd9e8941-4954-4a98-9de7-83dff04395c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B818E10>]}
[0m11:33:35.926224 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:35.926224 [debug] [MainThread]: On master: BEGIN
[0m11:33:35.927224 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:35.933224 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:35.933224 [debug] [MainThread]: On master: COMMIT
[0m11:33:35.933224 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:35.934225 [debug] [MainThread]: On master: COMMIT
[0m11:33:35.934225 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:35.935224 [debug] [MainThread]: On master: Close
[0m11:33:35.936268 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:33:35.937224 [info ] [MainThread]: 
[0m11:33:35.940225 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:33:35.940225 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:33:35.941225 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:33:35.942225 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:33:35.947223 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:33:35.948224 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:33:35.942225 => 11:33:35.948224
[0m11:33:35.949225 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:33:35.973593 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:33:35.974594 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:35.975592 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:33:35.975592 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:33:35.981917 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:35.981917 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:35.982947 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:33:35.983946 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:35.989918 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:35.991916 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:33:35.993918 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:35.997915 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:35.998915 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:33:35.998915 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:36.013414 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:33:36.014415 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:36.014415 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:33:36.018575 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:36.022656 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:36.022656 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:33:36.025623 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:36.026648 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:33:35.949225 => 11:33:36.026648
[0m11:33:36.026648 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:33:36.033819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9e8941-4954-4a98-9de7-83dff04395c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B496110>]}
[0m11:33:36.034815 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m11:33:36.035815 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:33:36.035815 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:33:36.036815 [info ] [Thread-1 (]: 2 of 3 START sql external model main.test ...................................... [RUN]
[0m11:33:36.037818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:33:36.037818 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:33:36.040834 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:33:36.041815 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:33:36.038843 => 11:33:36.040834
[0m11:33:36.041815 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:33:36.061082 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:33:36.062075 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:33:36.062075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:36.077240 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:36.077240 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:33:36.078460 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      



SELECT 
    region,
    SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
    SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
    SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
    SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY 
    region;
    );
  
  
[0m11:33:36.078460 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:33:36.041815 => 11:33:36.078460
[0m11:33:36.079496 [debug] [Thread-1 (]: On model.assignment1.test: ROLLBACK
[0m11:33:36.082481 [debug] [Thread-1 (]: Failed to rollback 'model.assignment1.test'
[0m11:33:36.083480 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:33:36.086526 [debug] [Thread-1 (]: Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near ";"
[0m11:33:36.087455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9e8941-4954-4a98-9de7-83dff04395c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B9DECD0>]}
[0m11:33:36.088522 [error] [Thread-1 (]: 2 of 3 ERROR creating sql external model main.test ............................. [[31mERROR[0m in 0.05s]
[0m11:33:36.089489 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:33:36.089489 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:33:36.090516 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:33:36.091451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:33:36.091451 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:33:36.093522 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:33:36.094534 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:33:36.091451 => 11:33:36.094534
[0m11:33:36.094534 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:33:36.109070 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:33:36.110180 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:36.110180 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:33:36.111178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:36.117183 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:36.117183 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:36.118168 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:33:36.118168 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:36.122472 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:36.122472 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:33:36.123485 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:36.125470 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:36.126465 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:33:36.128506 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:36.129673 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:33:36.130638 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:36.130638 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:33:36.134574 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:36.137642 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:36.138641 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:33:36.140644 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:36.142655 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:33:36.094534 => 11:33:36.141632
[0m11:33:36.143629 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:33:36.148831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd9e8941-4954-4a98-9de7-83dff04395c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011B5EFDD0>]}
[0m11:33:36.149964 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m11:33:36.149964 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:33:36.151961 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:36.151961 [debug] [MainThread]: On master: BEGIN
[0m11:33:36.152969 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:36.165288 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:36.166295 [debug] [MainThread]: On master: COMMIT
[0m11:33:36.166295 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:36.166295 [debug] [MainThread]: On master: COMMIT
[0m11:33:36.167309 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:36.167309 [debug] [MainThread]: On master: Close
[0m11:33:36.169530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:36.169530 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:33:36.170623 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:33:36.170623 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:33:36.170623 [info ] [MainThread]: 
[0m11:33:36.171638 [info ] [MainThread]: Finished running 1 table model, 1 external model, 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m11:33:36.173628 [debug] [MainThread]: Command end result
[0m11:33:36.181062 [info ] [MainThread]: 
[0m11:33:36.182054 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:33:36.183065 [info ] [MainThread]: 
[0m11:33:36.183430 [error] [MainThread]:   Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near ";"
[0m11:33:36.183430 [info ] [MainThread]: 
[0m11:33:36.184553 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:33:36.185478 [debug] [MainThread]: Command `dbt run` failed at 11:33:36.185478 after 0.81 seconds
[0m11:33:36.186466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011538C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011545F7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002011545EB50>]}
[0m11:33:36.186466 [debug] [MainThread]: Flushing usage events
[0m11:33:43.365785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF6467AF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF64683F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF64683390>]}


============================== 11:33:43.368862 | 98d6e3c1-db28-41eb-9448-6424ce29719f ==============================
[0m11:33:43.368862 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:33:43.369026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:33:43.549983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98d6e3c1-db28-41eb-9448-6424ce29719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF6472A190>]}
[0m11:33:43.628825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98d6e3c1-db28-41eb-9448-6424ce29719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF6475A310>]}
[0m11:33:43.629826 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:33:43.640828 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:33:43.716809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:33:43.717802 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:33:43.820706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98d6e3c1-db28-41eb-9448-6424ce29719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF646BA510>]}
[0m11:33:43.831295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98d6e3c1-db28-41eb-9448-6424ce29719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF64BF0950>]}
[0m11:33:43.832286 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:33:43.832286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98d6e3c1-db28-41eb-9448-6424ce29719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF64A70B90>]}
[0m11:33:43.834286 [info ] [MainThread]: 
[0m11:33:43.835285 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:33:43.836288 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:33:43.845286 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:33:43.846284 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:33:43.846284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:43.856289 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:43.857802 [debug] [ThreadPool]: On list_dev: Close
[0m11:33:43.860406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:33:43.861362 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:33:43.866419 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:33:43.867366 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:33:43.867366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:33:43.875663 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:43.878121 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:33:43.878121 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:33:43.878121 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:43.879363 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:33:43.879363 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:33:43.880402 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:43.881432 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:33:43.881432 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:33:43.881432 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:33:43.882887 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:43.882887 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:33:43.886434 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:33:43.890731 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:33:43.890731 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:33:43.891691 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:33:43.897714 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:43.897714 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:33:43.897714 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:33:43.925049 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:33:43.930051 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:33:43.930051 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:33:43.931241 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:33:43.934288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98d6e3c1-db28-41eb-9448-6424ce29719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF64A97690>]}
[0m11:33:43.934288 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:43.935381 [debug] [MainThread]: On master: BEGIN
[0m11:33:43.935381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:33:43.941152 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:43.941152 [debug] [MainThread]: On master: COMMIT
[0m11:33:43.942203 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:43.942203 [debug] [MainThread]: On master: COMMIT
[0m11:33:43.943113 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:43.943113 [debug] [MainThread]: On master: Close
[0m11:33:43.945585 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:33:43.945585 [info ] [MainThread]: 
[0m11:33:43.948575 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:33:43.950032 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:33:43.952329 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:33:43.953395 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:33:43.959643 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:33:43.960734 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:33:43.954384 => 11:33:43.960734
[0m11:33:43.960734 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:33:43.985270 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:33:43.986255 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:43.987203 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:33:43.987203 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:33:43.993535 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:43.994533 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:43.994533 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:33:43.995503 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.001394 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:44.001394 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:33:44.002402 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.005510 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:44.006508 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:33:44.006508 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.020398 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:33:44.021401 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:44.021401 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:33:44.024388 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.028393 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:33:44.029403 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:33:44.031490 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.032494 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:33:43.961692 => 11:33:44.032494
[0m11:33:44.033494 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:33:44.039495 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d6e3c1-db28-41eb-9448-6424ce29719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF64FB6DD0>]}
[0m11:33:44.040495 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m11:33:44.040495 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:33:44.041496 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:33:44.041496 [info ] [Thread-1 (]: 2 of 3 START sql external model main.test ...................................... [RUN]
[0m11:33:44.042495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:33:44.042495 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:33:44.045514 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:33:44.046494 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:33:44.043494 => 11:33:44.045514
[0m11:33:44.046494 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:33:44.064997 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:33:44.065998 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:33:44.065998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:44.081273 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.082311 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:33:44.083447 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      



SELECT 
    region,
    SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
    SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
    SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
    SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY 
    region
    );
  
  
[0m11:33:44.149079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.152220 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:33:44.153293 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
copy "dev"."main"."test__dbt_tmp" to 'output/test.csv' (format csv, header 1)
[0m11:33:44.156079 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.158589 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:33:44.158589 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:33:44.159590 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
create or replace view "dev"."main"."test__dbt_int" as (
        select * from 'output/test.csv'
    );
[0m11:33:44.167063 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.169247 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:33:44.170389 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test" rename to "test__dbt_backup"
[0m11:33:44.170389 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.172401 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:33:44.173538 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test__dbt_int" rename to "test"
[0m11:33:44.173538 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.175570 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:33:44.175570 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:33:44.176459 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:33:44.178568 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.180919 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:33:44.181960 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop view if exists "dev"."main"."test__dbt_backup" cascade
[0m11:33:44.182919 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.187126 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:33:44.187126 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_tmp" cascade
[0m11:33:44.189369 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.190513 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:33:44.046494 => 11:33:44.190513
[0m11:33:44.190513 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:33:44.200379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d6e3c1-db28-41eb-9448-6424ce29719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF64BE9450>]}
[0m11:33:44.201378 [info ] [Thread-1 (]: 2 of 3 OK created sql external model main.test ................................. [[32mOK[0m in 0.16s]
[0m11:33:44.202382 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:33:44.202382 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:33:44.203376 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:33:44.203376 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:33:44.204508 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:33:44.206465 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:33:44.207418 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:33:44.204508 => 11:33:44.207418
[0m11:33:44.207418 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:33:44.222166 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:33:44.222166 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:44.223637 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:33:44.223637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:33:44.236647 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.237684 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:44.238774 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:33:44.238774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.242828 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:44.243836 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:33:44.244802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.247278 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:44.248291 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:33:44.249577 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.250578 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:33:44.251620 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:44.251620 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:33:44.254042 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.256070 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:33:44.256070 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:33:44.261306 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:33:44.262305 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:33:44.207418 => 11:33:44.262305
[0m11:33:44.262305 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:33:44.269522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d6e3c1-db28-41eb-9448-6424ce29719f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF64EE6050>]}
[0m11:33:44.270521 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m11:33:44.270521 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:33:44.273018 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:44.273018 [debug] [MainThread]: On master: BEGIN
[0m11:33:44.274026 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:33:44.285227 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:44.285227 [debug] [MainThread]: On master: COMMIT
[0m11:33:44.286466 [debug] [MainThread]: Using duckdb connection "master"
[0m11:33:44.287553 [debug] [MainThread]: On master: COMMIT
[0m11:33:44.287553 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:33:44.288507 [debug] [MainThread]: On master: Close
[0m11:33:44.290696 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:33:44.290696 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:33:44.290696 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:33:44.291623 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:33:44.291623 [info ] [MainThread]: 
[0m11:33:44.292629 [info ] [MainThread]: Finished running 1 table model, 1 external model, 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m11:33:44.293571 [debug] [MainThread]: Command end result
[0m11:33:44.301798 [info ] [MainThread]: 
[0m11:33:44.301798 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:33:44.302809 [info ] [MainThread]: 
[0m11:33:44.302809 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:33:44.303805 [debug] [MainThread]: Command `dbt run` succeeded at 11:33:44.303805 after 0.99 seconds
[0m11:33:44.304837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5E98C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF64335990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF5EE78D50>]}
[0m11:33:44.305806 [debug] [MainThread]: Flushing usage events
[0m11:35:49.395923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000201094898D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010C47AB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010C4832D0>]}


============================== 11:35:49.407789 | 2b2a3db8-a3d3-4f8a-98e9-44da8575884a ==============================
[0m11:35:49.407789 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:35:49.407789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:35:49.543876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b2a3db8-a3d3-4f8a-98e9-44da8575884a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010C4B5410>]}
[0m11:35:49.591388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b2a3db8-a3d3-4f8a-98e9-44da8575884a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010C559B50>]}
[0m11:35:49.591388 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:35:49.607633 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:35:49.696644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:35:49.697663 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:35:49.777078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b2a3db8-a3d3-4f8a-98e9-44da8575884a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010CD25A90>]}
[0m11:35:49.795508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b2a3db8-a3d3-4f8a-98e9-44da8575884a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010C9E8DD0>]}
[0m11:35:49.796089 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:35:49.796089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b2a3db8-a3d3-4f8a-98e9-44da8575884a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010A954E50>]}
[0m11:35:49.796089 [info ] [MainThread]: 
[0m11:35:49.796089 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:35:49.796089 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:35:49.796089 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:35:49.796089 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:35:49.796089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:49.814052 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:49.814052 [debug] [ThreadPool]: On list_dev: Close
[0m11:35:49.814052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:35:49.814052 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:35:49.814052 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:35:49.814052 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:35:49.814052 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:35:49.828773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:49.828773 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:35:49.828773 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:35:49.828773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:49.828773 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:35:49.828773 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:35:49.828773 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:49.839523 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:35:49.839523 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:35:49.840470 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:35:49.840470 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:49.840470 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:35:49.844835 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:35:49.847065 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:35:49.847065 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:35:49.847065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:35:49.852092 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:49.852092 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:35:49.852092 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:35:49.881254 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:35:49.881254 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:35:49.881254 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:35:49.881254 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:35:49.893820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b2a3db8-a3d3-4f8a-98e9-44da8575884a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010BC81690>]}
[0m11:35:49.893820 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:49.893820 [debug] [MainThread]: On master: BEGIN
[0m11:35:49.894901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:49.895665 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:49.895665 [debug] [MainThread]: On master: COMMIT
[0m11:35:49.895665 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:49.895665 [debug] [MainThread]: On master: COMMIT
[0m11:35:49.895665 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:49.895665 [debug] [MainThread]: On master: Close
[0m11:35:49.895665 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:35:49.895665 [info ] [MainThread]: 
[0m11:35:49.895665 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:35:49.895665 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:35:49.895665 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:35:49.910741 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:35:49.916690 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:35:49.916690 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:35:49.910741 => 11:35:49.916690
[0m11:35:49.916690 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:35:49.931038 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:35:49.931038 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:35:49.931038 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:35:49.931038 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:35:49.948892 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:49.948892 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:35:49.948892 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:35:49.952208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:49.952208 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:35:49.952208 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:35:49.952208 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:49.952208 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:35:49.961576 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:35:49.961576 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:49.963888 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:35:49.963888 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:35:49.963888 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:35:49.982184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:49.982184 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:35:49.982184 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:35:49.982184 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:49.982184 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:35:49.916690 => 11:35:49.982184
[0m11:35:49.982184 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:35:49.998916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b2a3db8-a3d3-4f8a-98e9-44da8575884a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010CDB3C50>]}
[0m11:35:49.999914 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m11:35:50.000918 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:35:50.001917 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:35:50.001917 [info ] [Thread-1 (]: 2 of 3 START sql external model main.test ...................................... [RUN]
[0m11:35:50.002916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:35:50.003954 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:35:50.005914 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:35:50.006914 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:35:50.003954 => 11:35:50.005914
[0m11:35:50.006914 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:35:50.024991 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:35:50.026005 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:35:50.026005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:50.039819 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:50.039819 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:35:50.039819 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      

WITH dim_reg_pass(
SELECT 
    region,
    SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
    SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
    SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
    SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY 
    region
)
SELECT 
*
from dim_reg_pass
    );
  
  
[0m11:35:50.039819 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:35:50.006914 => 11:35:50.039819
[0m11:35:50.039819 [debug] [Thread-1 (]: On model.assignment1.test: ROLLBACK
[0m11:35:50.047907 [debug] [Thread-1 (]: Failed to rollback 'model.assignment1.test'
[0m11:35:50.048907 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:35:50.050873 [debug] [Thread-1 (]: Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near "SELECT"
[0m11:35:50.050873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b2a3db8-a3d3-4f8a-98e9-44da8575884a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010C8FA310>]}
[0m11:35:50.050873 [error] [Thread-1 (]: 2 of 3 ERROR creating sql external model main.test ............................. [[31mERROR[0m in 0.05s]
[0m11:35:50.055000 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:35:50.055000 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:35:50.055000 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:35:50.055000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:35:50.055000 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:35:50.057898 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:35:50.057898 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:35:50.057898 => 11:35:50.057898
[0m11:35:50.057898 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:35:50.064509 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:35:50.064509 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:35:50.064509 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:35:50.064509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:35:50.080320 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:50.081100 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:35:50.081100 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:35:50.081100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:50.081100 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:35:50.081100 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:35:50.081100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:50.081100 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:35:50.081100 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:35:50.081100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:50.081100 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:35:50.081100 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:35:50.081100 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:35:50.081100 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:50.081100 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:35:50.094890 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:35:50.097401 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:35:50.099494 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:35:50.057898 => 11:35:50.098462
[0m11:35:50.100042 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:35:50.100042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b2a3db8-a3d3-4f8a-98e9-44da8575884a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010C4D9990>]}
[0m11:35:50.100042 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m11:35:50.100042 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:35:50.100042 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:50.111399 [debug] [MainThread]: On master: BEGIN
[0m11:35:50.112409 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:35:50.116844 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:50.128112 [debug] [MainThread]: On master: COMMIT
[0m11:35:50.129251 [debug] [MainThread]: Using duckdb connection "master"
[0m11:35:50.129251 [debug] [MainThread]: On master: COMMIT
[0m11:35:50.130183 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:35:50.130961 [debug] [MainThread]: On master: Close
[0m11:35:50.130961 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:35:50.130961 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:35:50.130961 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:35:50.130961 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:35:50.130961 [info ] [MainThread]: 
[0m11:35:50.130961 [info ] [MainThread]: Finished running 1 table model, 1 external model, 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m11:35:50.130961 [debug] [MainThread]: Command end result
[0m11:35:50.130961 [info ] [MainThread]: 
[0m11:35:50.144775 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:35:50.145934 [info ] [MainThread]: 
[0m11:35:50.147027 [error] [MainThread]:   Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near "SELECT"
[0m11:35:50.147946 [info ] [MainThread]: 
[0m11:35:50.148946 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:35:50.149664 [debug] [MainThread]: Command `dbt run` failed at 11:35:50.149664 after 0.81 seconds
[0m11:35:50.149664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010678C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010C483F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002010685EB50>]}
[0m11:35:50.149664 [debug] [MainThread]: Flushing usage events
[0m11:36:15.113831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34087B9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3408604D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3408606D0>]}


============================== 11:36:15.116076 | 22dcf560-226b-4db4-b2fc-63903d87a7a4 ==============================
[0m11:36:15.116076 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:36:15.116076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:36:15.272931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22dcf560-226b-4db4-b2fc-63903d87a7a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3408D08D0>]}
[0m11:36:15.333074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22dcf560-226b-4db4-b2fc-63903d87a7a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C34082BA90>]}
[0m11:36:15.333074 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:36:15.333074 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:36:15.407696 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:36:15.407696 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:36:15.513145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22dcf560-226b-4db4-b2fc-63903d87a7a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C340DB2D90>]}
[0m11:36:15.523420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22dcf560-226b-4db4-b2fc-63903d87a7a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C340DF0CD0>]}
[0m11:36:15.524420 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:36:15.525418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22dcf560-226b-4db4-b2fc-63903d87a7a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3409A2D10>]}
[0m11:36:15.527413 [info ] [MainThread]: 
[0m11:36:15.528417 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:36:15.529416 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:36:15.539476 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:36:15.539476 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:36:15.539476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:15.539476 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:15.539476 [debug] [ThreadPool]: On list_dev: Close
[0m11:36:15.552783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:36:15.554786 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:36:15.554786 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:15.554786 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:36:15.554786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:15.554786 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:15.570796 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:15.571335 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:36:15.571335 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:15.571335 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:15.571335 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:36:15.573887 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:15.573887 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:36:15.573887 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:15.573887 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:36:15.573887 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:15.573887 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:36:15.578287 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:36:15.578287 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:36:15.578287 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:36:15.578287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:15.588063 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:15.588063 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:36:15.588063 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:36:15.621361 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:15.621361 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:36:15.621361 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:36:15.621361 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:36:15.621361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22dcf560-226b-4db4-b2fc-63903d87a7a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C340CCEE90>]}
[0m11:36:15.621361 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:15.621361 [debug] [MainThread]: On master: BEGIN
[0m11:36:15.621361 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:15.639443 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:36:15.640444 [debug] [MainThread]: On master: COMMIT
[0m11:36:15.640444 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:15.641446 [debug] [MainThread]: On master: COMMIT
[0m11:36:15.641446 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:36:15.641446 [debug] [MainThread]: On master: Close
[0m11:36:15.643434 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:15.644434 [info ] [MainThread]: 
[0m11:36:15.647897 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:36:15.647897 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:36:15.649191 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:36:15.650314 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:36:15.657030 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:36:15.657030 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:36:15.650314 => 11:36:15.657030
[0m11:36:15.657030 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:36:15.688401 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:36:15.690441 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:15.690441 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:36:15.690441 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:36:15.690441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.690441 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:15.690441 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:36:15.690441 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.706393 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:15.707102 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:36:15.707787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.707787 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:15.707787 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:36:15.707787 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.729157 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:36:15.730158 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:15.730158 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:36:15.735025 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.739254 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:15.740271 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:36:15.742804 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.743821 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:36:15.657030 => 11:36:15.743821
[0m11:36:15.744821 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:36:15.751820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22dcf560-226b-4db4-b2fc-63903d87a7a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C341415190>]}
[0m11:36:15.752820 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.10s]
[0m11:36:15.754181 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:36:15.755201 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:36:15.755201 [info ] [Thread-1 (]: 2 of 3 START sql external model main.test ...................................... [RUN]
[0m11:36:15.756203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:36:15.757231 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:36:15.759220 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:36:15.760239 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:36:15.757231 => 11:36:15.760239
[0m11:36:15.760239 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:36:15.775930 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:36:15.775930 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:36:15.775930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:15.792427 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.792427 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:36:15.792427 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      

WITH dim_reg_pass(
SELECT 
    region,
    SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
    SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
    SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
    SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY 
    region
)
SELECT 
 *
from dim_reg_pass
    );
  
  
[0m11:36:15.792427 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:36:15.760239 => 11:36:15.792427
[0m11:36:15.792427 [debug] [Thread-1 (]: On model.assignment1.test: ROLLBACK
[0m11:36:15.792427 [debug] [Thread-1 (]: Failed to rollback 'model.assignment1.test'
[0m11:36:15.792427 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:36:15.792427 [debug] [Thread-1 (]: Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near "SELECT"
[0m11:36:15.792427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22dcf560-226b-4db4-b2fc-63903d87a7a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C340CEF4D0>]}
[0m11:36:15.792427 [error] [Thread-1 (]: 2 of 3 ERROR creating sql external model main.test ............................. [[31mERROR[0m in 0.04s]
[0m11:36:15.803928 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:36:15.804937 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:36:15.805934 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:36:15.806565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:36:15.806565 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:36:15.806565 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:36:15.806565 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:36:15.806565 => 11:36:15.806565
[0m11:36:15.806565 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:36:15.822456 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:36:15.822456 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:15.822456 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:36:15.822456 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:15.822456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.822456 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:15.822456 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:36:15.822456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.839299 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:15.840299 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:36:15.841298 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.842927 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:15.842927 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:36:15.842927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.842927 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:36:15.842927 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:15.842927 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:36:15.842927 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.842927 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:15.842927 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:36:15.854823 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:15.856823 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:36:15.806565 => 11:36:15.856823
[0m11:36:15.856823 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:36:15.858772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22dcf560-226b-4db4-b2fc-63903d87a7a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3408C9C90>]}
[0m11:36:15.858772 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m11:36:15.858772 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:36:15.858772 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:15.858772 [debug] [MainThread]: On master: BEGIN
[0m11:36:15.858772 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:15.873067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:36:15.873067 [debug] [MainThread]: On master: COMMIT
[0m11:36:15.873067 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:15.873067 [debug] [MainThread]: On master: COMMIT
[0m11:36:15.873067 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:36:15.873067 [debug] [MainThread]: On master: Close
[0m11:36:15.873067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:15.873067 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:36:15.873067 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:36:15.873067 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:36:15.873067 [info ] [MainThread]: 
[0m11:36:15.887162 [info ] [MainThread]: Finished running 1 table model, 1 external model, 1 view model in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m11:36:15.888170 [debug] [MainThread]: Command end result
[0m11:36:15.889511 [info ] [MainThread]: 
[0m11:36:15.889511 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:36:15.889511 [info ] [MainThread]: 
[0m11:36:15.889511 [error] [MainThread]:   Runtime Error in model test (models\test\test.sql)
  Parser Error: syntax error at or near "SELECT"
[0m11:36:15.889511 [info ] [MainThread]: 
[0m11:36:15.889511 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m11:36:15.889511 [debug] [MainThread]: Command `dbt run` failed at 11:36:15.889511 after 0.84 seconds
[0m11:36:15.889511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C33AB8C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C340282B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C340D098D0>]}
[0m11:36:15.889511 [debug] [MainThread]: Flushing usage events
[0m11:36:47.100190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263CA02B6D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C7714790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263CA083F50>]}


============================== 11:36:47.100190 | b3bb8de5-9035-41f3-a10a-2081329d9352 ==============================
[0m11:36:47.100190 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:36:47.100190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:36:47.266120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b3bb8de5-9035-41f3-a10a-2081329d9352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263CA0CB110>]}
[0m11:36:47.321438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b3bb8de5-9035-41f3-a10a-2081329d9352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263CA1591D0>]}
[0m11:36:47.321438 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:36:47.321438 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:36:47.377384 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:36:47.377384 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\test\test.sql
[0m11:36:47.473275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3bb8de5-9035-41f3-a10a-2081329d9352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263CA964450>]}
[0m11:36:47.488902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b3bb8de5-9035-41f3-a10a-2081329d9352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263CA5F0890>]}
[0m11:36:47.488902 [info ] [MainThread]: Found 3 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:36:47.488902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3bb8de5-9035-41f3-a10a-2081329d9352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263CA0DF3D0>]}
[0m11:36:47.488902 [info ] [MainThread]: 
[0m11:36:47.488902 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:36:47.488902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:36:47.488902 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:36:47.488902 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:36:47.488902 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:47.509291 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:47.509291 [debug] [ThreadPool]: On list_dev: Close
[0m11:36:47.509291 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:36:47.509291 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:36:47.509291 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:47.509291 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:36:47.509291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:36:47.524891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:47.524891 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:47.524891 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:36:47.524891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:47.524891 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:47.524891 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:36:47.524891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:47.524891 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:36:47.524891 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:36:47.524891 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:36:47.524891 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:47.524891 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:36:47.539969 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:36:47.541295 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:36:47.541295 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:36:47.541295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:36:47.541295 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:47.541295 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:36:47.541295 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:36:47.574772 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:36:47.574772 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:36:47.574772 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:36:47.574772 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:36:47.591681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b3bb8de5-9035-41f3-a10a-2081329d9352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263CA80E650>]}
[0m11:36:47.591681 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:47.591681 [debug] [MainThread]: On master: BEGIN
[0m11:36:47.591681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:36:47.591681 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:36:47.591681 [debug] [MainThread]: On master: COMMIT
[0m11:36:47.591681 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:47.591681 [debug] [MainThread]: On master: COMMIT
[0m11:36:47.591681 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:36:47.591681 [debug] [MainThread]: On master: Close
[0m11:36:47.591681 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:36:47.591681 [info ] [MainThread]: 
[0m11:36:47.606201 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:36:47.606201 [info ] [Thread-1 (]: 1 of 3 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:36:47.608547 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.my_first_dbt_model'
[0m11:36:47.608547 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:36:47.613141 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:36:47.613141 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:36:47.608547 => 11:36:47.613141
[0m11:36:47.613141 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:36:47.640936 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:36:47.643012 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:47.643012 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:36:47.643012 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:36:47.643012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.643012 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:47.643012 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:36:47.643012 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.643012 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:47.643012 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:36:47.657630 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.660783 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:47.660783 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:36:47.661854 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.676362 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:36:47.676362 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:47.676362 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:36:47.676362 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.676362 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:36:47.676362 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:36:47.690864 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.695259 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:36:47.613141 => 11:36:47.695259
[0m11:36:47.695259 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:36:47.695259 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bb8de5-9035-41f3-a10a-2081329d9352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263CA9404D0>]}
[0m11:36:47.695259 [info ] [Thread-1 (]: 1 of 3 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m11:36:47.707325 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:36:47.707325 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:36:47.708472 [info ] [Thread-1 (]: 2 of 3 START sql external model main.test ...................................... [RUN]
[0m11:36:47.709304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:36:47.709304 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:36:47.712435 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:36:47.713445 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:36:47.710434 => 11:36:47.712435
[0m11:36:47.713445 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:36:47.731436 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:36:47.732434 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:36:47.732434 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:47.744802 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.744802 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:36:47.744802 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      

WITH dim_reg_pass AS(
SELECT 
    region,
    SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
    SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
    SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
    SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY 
    region
)

SELECT 
 *
from dim_reg_pass
    );
  
  
[0m11:36:47.809488 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.812539 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:36:47.813420 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
copy "dev"."main"."test__dbt_tmp" to 'output/test.csv' (format csv, header 1)
[0m11:36:47.815423 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.815423 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:36:47.816791 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:36:47.816791 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
create or replace view "dev"."main"."test__dbt_int" as (
        select * from 'output/test.csv'
    );
[0m11:36:47.823060 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.825210 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:36:47.826209 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test" rename to "test__dbt_backup"
[0m11:36:47.826209 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.828573 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:36:47.828573 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test__dbt_int" rename to "test"
[0m11:36:47.829608 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.830591 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:36:47.831655 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:36:47.831655 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:36:47.833601 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.835700 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:36:47.835700 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop view if exists "dev"."main"."test__dbt_backup" cascade
[0m11:36:47.837713 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.839707 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:36:47.839707 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_tmp" cascade
[0m11:36:47.841853 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.841853 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:36:47.713445 => 11:36:47.841853
[0m11:36:47.841853 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:36:47.849541 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bb8de5-9035-41f3-a10a-2081329d9352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263CAA0B8D0>]}
[0m11:36:47.849541 [info ] [Thread-1 (]: 2 of 3 OK created sql external model main.test ................................. [[32mOK[0m in 0.14s]
[0m11:36:47.849541 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:36:47.849541 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:36:47.849541 [info ] [Thread-1 (]: 3 of 3 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:36:47.854059 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:36:47.854724 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:36:47.855465 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:36:47.857557 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:36:47.854724 => 11:36:47.857557
[0m11:36:47.858678 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:36:47.862632 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:36:47.862632 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:47.862632 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:36:47.862632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:36:47.876648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.876648 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:47.876648 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:36:47.876648 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.876648 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:47.890583 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:36:47.890583 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.893641 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:47.894594 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:36:47.895586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.895586 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:36:47.895586 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:47.895586 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:36:47.895586 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.895586 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:36:47.895586 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:36:47.907217 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:36:47.908474 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:36:47.859553 => 11:36:47.908474
[0m11:36:47.908474 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:36:47.909953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b3bb8de5-9035-41f3-a10a-2081329d9352', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263CA538410>]}
[0m11:36:47.909953 [info ] [Thread-1 (]: 3 of 3 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m11:36:47.909953 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:36:47.909953 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:47.909953 [debug] [MainThread]: On master: BEGIN
[0m11:36:47.909953 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:36:47.925856 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:36:47.925856 [debug] [MainThread]: On master: COMMIT
[0m11:36:47.925856 [debug] [MainThread]: Using duckdb connection "master"
[0m11:36:47.925856 [debug] [MainThread]: On master: COMMIT
[0m11:36:47.925856 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:36:47.925856 [debug] [MainThread]: On master: Close
[0m11:36:47.925856 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:36:47.925856 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:36:47.925856 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:36:47.925856 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:36:47.925856 [info ] [MainThread]: 
[0m11:36:47.925856 [info ] [MainThread]: Finished running 1 table model, 1 external model, 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m11:36:47.940587 [debug] [MainThread]: Command end result
[0m11:36:47.942341 [info ] [MainThread]: 
[0m11:36:47.950884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:36:47.950884 [info ] [MainThread]: 
[0m11:36:47.950884 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:36:47.950884 [debug] [MainThread]: Command `dbt run` succeeded at 11:36:47.950884 after 0.89 seconds
[0m11:36:47.950884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C438C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C4878E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000263C445EAD0>]}
[0m11:36:47.950884 [debug] [MainThread]: Flushing usage events
[0m11:41:13.465783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E563382B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5633685D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E56336A010>]}


============================== 11:41:13.468861 | e0d63cc2-1c9e-437d-bd92-c887190a2747 ==============================
[0m11:41:13.468861 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:41:13.469213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:41:13.630892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0d63cc2-1c9e-437d-bd92-c887190a2747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5636D0750>]}
[0m11:41:13.684487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0d63cc2-1c9e-437d-bd92-c887190a2747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E562B516D0>]}
[0m11:41:13.685485 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:41:13.690772 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:41:13.755994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m11:41:13.759373 [debug] [MainThread]: Partial parsing: added file: assignment1://models\edu-res\edu-res.sql
[0m11:41:13.850925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0d63cc2-1c9e-437d-bd92-c887190a2747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5633BA110>]}
[0m11:41:13.860310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0d63cc2-1c9e-437d-bd92-c887190a2747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E563AF1F50>]}
[0m11:41:13.860310 [info ] [MainThread]: Found 4 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:41:13.861323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0d63cc2-1c9e-437d-bd92-c887190a2747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5633CFE90>]}
[0m11:41:13.862371 [info ] [MainThread]: 
[0m11:41:13.863363 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:41:13.865672 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:41:13.874310 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:41:13.875307 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:41:13.875307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:13.884869 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:13.885970 [debug] [ThreadPool]: On list_dev: Close
[0m11:41:13.889092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:41:13.889092 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:41:13.895899 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:13.896951 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:41:13.896951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:13.903198 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:13.904246 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:13.905324 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:41:13.905324 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:13.905324 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:13.906288 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:41:13.906288 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:13.907286 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:41:13.908191 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:13.909196 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:41:13.910276 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:13.910276 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:41:13.914613 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:41:13.918872 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:41:13.918872 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:41:13.918872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:13.926243 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:13.927523 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:41:13.927523 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:41:13.954856 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:13.960866 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:41:13.961844 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:41:13.962809 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:41:13.965982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0d63cc2-1c9e-437d-bd92-c887190a2747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E563A02450>]}
[0m11:41:13.965982 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:13.965982 [debug] [MainThread]: On master: BEGIN
[0m11:41:13.966990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:13.972991 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:13.973990 [debug] [MainThread]: On master: COMMIT
[0m11:41:13.973990 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:13.974994 [debug] [MainThread]: On master: COMMIT
[0m11:41:13.975992 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:13.975992 [debug] [MainThread]: On master: Close
[0m11:41:13.978105 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:13.978991 [info ] [MainThread]: 
[0m11:41:13.980989 [debug] [Thread-1 (]: Began running node model.assignment1.edu-res
[0m11:41:13.982098 [info ] [Thread-1 (]: 1 of 4 START sql external model main.edu-res ................................... [RUN]
[0m11:41:13.982990 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.edu-res'
[0m11:41:13.984062 [debug] [Thread-1 (]: Began compiling node model.assignment1.edu-res
[0m11:41:13.989098 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.edu-res"
[0m11:41:13.990990 [debug] [Thread-1 (]: Timing info for model.assignment1.edu-res (compile): 11:41:13.984062 => 11:41:13.990990
[0m11:41:13.992991 [debug] [Thread-1 (]: Began executing node model.assignment1.edu-res
[0m11:41:14.034656 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:41:14.034656 [debug] [Thread-1 (]: On model.assignment1.edu-res: BEGIN
[0m11:41:14.035640 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:41:14.042886 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.043888 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:41:14.043888 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */

  
    
    

    create  table
      "dev"."main"."edu-res__dbt_tmp"
  
    as (
      

SELECT highest_education,
       SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
       SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
       SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
       SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY highest_education;
    );
  
  
[0m11:41:14.044885 [debug] [Thread-1 (]: Timing info for model.assignment1.edu-res (execute): 11:41:13.992991 => 11:41:14.044885
[0m11:41:14.044885 [debug] [Thread-1 (]: On model.assignment1.edu-res: ROLLBACK
[0m11:41:14.048903 [debug] [Thread-1 (]: Failed to rollback 'model.assignment1.edu-res'
[0m11:41:14.049152 [debug] [Thread-1 (]: On model.assignment1.edu-res: Close
[0m11:41:14.052154 [debug] [Thread-1 (]: Runtime Error in model edu-res (models\edu-res\edu-res.sql)
  Parser Error: syntax error at or near ";"
[0m11:41:14.053155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0d63cc2-1c9e-437d-bd92-c887190a2747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E563382710>]}
[0m11:41:14.053155 [error] [Thread-1 (]: 1 of 4 ERROR creating sql external model main.edu-res .......................... [[31mERROR[0m in 0.07s]
[0m11:41:14.054154 [debug] [Thread-1 (]: Finished running node model.assignment1.edu-res
[0m11:41:14.054154 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:41:14.055154 [info ] [Thread-1 (]: 2 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:41:14.055926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.edu-res, now model.assignment1.my_first_dbt_model)
[0m11:41:14.055926 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:41:14.059005 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:41:14.060039 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:41:14.057063 => 11:41:14.060039
[0m11:41:14.060039 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:41:14.071045 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:41:14.071976 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:14.073242 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:41:14.073242 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:14.082165 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.082165 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:14.083194 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:41:14.084195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.088243 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:14.089316 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:41:14.089316 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.092727 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:14.092727 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:41:14.093842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.110999 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:41:14.112119 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:14.113095 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:41:14.117370 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.120542 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:14.121542 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:41:14.124524 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.126524 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:41:14.060994 => 11:41:14.126524
[0m11:41:14.127523 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:41:14.136732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0d63cc2-1c9e-437d-bd92-c887190a2747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E563DA3690>]}
[0m11:41:14.136732 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.08s]
[0m11:41:14.137733 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:41:14.138712 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:41:14.138869 [info ] [Thread-1 (]: 3 of 4 START sql external model main.test ...................................... [RUN]
[0m11:41:14.139756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:41:14.140793 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:41:14.143826 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:41:14.144808 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:41:14.140793 => 11:41:14.143826
[0m11:41:14.144808 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:41:14.147770 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:14.148772 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:41:14.148772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:14.159837 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.159837 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:14.160818 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      

WITH dim_reg_pass AS(
SELECT 
    region,
    SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
    SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
    SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
    SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY 
    region
)

SELECT 
 *
from dim_reg_pass
    );
  
  
[0m11:41:14.231481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.233611 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:14.234607 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
copy "dev"."main"."test__dbt_tmp" to 'output/test.csv' (format csv, header 1)
[0m11:41:14.238595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.239623 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:41:14.240954 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:14.240954 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
create or replace view "dev"."main"."test__dbt_int" as (
        select * from 'output/test.csv'
    );
[0m11:41:14.247267 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.249341 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:14.250344 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test" rename to "test__dbt_backup"
[0m11:41:14.251241 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.253312 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:14.253312 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test__dbt_int" rename to "test"
[0m11:41:14.254284 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.255298 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:41:14.256261 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:14.256261 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:41:14.260027 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.261548 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:14.262548 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop view if exists "dev"."main"."test__dbt_backup" cascade
[0m11:41:14.263734 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.265871 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:14.266875 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_tmp" cascade
[0m11:41:14.267746 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.268841 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:41:14.144808 => 11:41:14.268841
[0m11:41:14.269842 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:41:14.276752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0d63cc2-1c9e-437d-bd92-c887190a2747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E563A35C50>]}
[0m11:41:14.277752 [info ] [Thread-1 (]: 3 of 4 OK created sql external model main.test ................................. [[32mOK[0m in 0.14s]
[0m11:41:14.278807 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:41:14.279956 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:41:14.279956 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:41:14.281082 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:41:14.281082 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:41:14.283112 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:41:14.285043 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:41:14.282042 => 11:41:14.284116
[0m11:41:14.285043 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:41:14.299518 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:41:14.300618 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:14.300618 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:41:14.301480 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:14.316214 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.316214 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:14.317296 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:41:14.318221 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.320521 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:14.320521 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:41:14.321481 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.323529 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:14.324445 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:41:14.325495 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.327438 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:41:14.328440 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:14.328772 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:41:14.332189 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.334201 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:14.334201 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:41:14.336195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:14.337229 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:41:14.285043 => 11:41:14.337229
[0m11:41:14.337229 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:41:14.345784 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0d63cc2-1c9e-437d-bd92-c887190a2747', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E563DDAB50>]}
[0m11:41:14.346801 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m11:41:14.348015 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:41:14.350298 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:14.350298 [debug] [MainThread]: On master: BEGIN
[0m11:41:14.351296 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:14.365489 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:14.365489 [debug] [MainThread]: On master: COMMIT
[0m11:41:14.366493 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:14.366493 [debug] [MainThread]: On master: COMMIT
[0m11:41:14.366493 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:14.367492 [debug] [MainThread]: On master: Close
[0m11:41:14.368639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:14.369714 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:41:14.369714 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:41:14.370727 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:41:14.370727 [info ] [MainThread]: 
[0m11:41:14.371718 [info ] [MainThread]: Finished running 2 external models, 1 table model, 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m11:41:14.372710 [debug] [MainThread]: Command end result
[0m11:41:14.383673 [info ] [MainThread]: 
[0m11:41:14.384671 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:41:14.385677 [info ] [MainThread]: 
[0m11:41:14.386670 [error] [MainThread]:   Runtime Error in model edu-res (models\edu-res\edu-res.sql)
  Parser Error: syntax error at or near ";"
[0m11:41:14.387728 [info ] [MainThread]: 
[0m11:41:14.387728 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m11:41:14.389973 [debug] [MainThread]: Command `dbt run` failed at 11:41:14.388884 after 0.98 seconds
[0m11:41:14.389973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E55D68C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5633328D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E55D75F690>]}
[0m11:41:14.391402 [debug] [MainThread]: Flushing usage events
[0m11:41:20.858430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B809D839D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B809D82B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B809D83F50>]}


============================== 11:41:20.860831 | e1662c88-038e-4d9a-aea4-d57972fbaab8 ==============================
[0m11:41:20.860831 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:41:20.861836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:41:21.021684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1662c88-038e-4d9a-aea4-d57972fbaab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B80996BE50>]}
[0m11:41:21.078966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1662c88-038e-4d9a-aea4-d57972fbaab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B809D82790>]}
[0m11:41:21.080558 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:41:21.086559 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:41:21.157975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:41:21.159183 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\edu-res\edu-res.sql
[0m11:41:21.259192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1662c88-038e-4d9a-aea4-d57972fbaab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B80A43AD90>]}
[0m11:41:21.269194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1662c88-038e-4d9a-aea4-d57972fbaab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B80A4E84D0>]}
[0m11:41:21.270197 [info ] [MainThread]: Found 4 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:41:21.271233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1662c88-038e-4d9a-aea4-d57972fbaab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B809DCE210>]}
[0m11:41:21.273196 [info ] [MainThread]: 
[0m11:41:21.274195 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:41:21.275222 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:41:21.287772 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:41:21.287772 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:41:21.288928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:21.297930 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:21.298954 [debug] [ThreadPool]: On list_dev: Close
[0m11:41:21.303174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:41:21.304173 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:41:21.309329 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:21.309329 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:41:21.310331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:41:21.316331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:21.318331 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:21.319330 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:41:21.320330 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:21.320330 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:21.321330 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:41:21.322331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:21.324331 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:41:21.324331 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:41:21.325331 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:41:21.325331 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:21.326331 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:41:21.329417 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:41:21.334436 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:41:21.334436 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:41:21.335437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:41:21.342601 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:21.343602 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:41:21.343602 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:41:21.377075 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:41:21.383073 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:41:21.384075 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:41:21.385075 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:41:21.390074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1662c88-038e-4d9a-aea4-d57972fbaab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B80A1EE750>]}
[0m11:41:21.390074 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:21.391076 [debug] [MainThread]: On master: BEGIN
[0m11:41:21.391076 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:41:21.399087 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:21.400075 [debug] [MainThread]: On master: COMMIT
[0m11:41:21.400075 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:21.401075 [debug] [MainThread]: On master: COMMIT
[0m11:41:21.401075 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:21.402075 [debug] [MainThread]: On master: Close
[0m11:41:21.404074 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:41:21.405076 [info ] [MainThread]: 
[0m11:41:21.408076 [debug] [Thread-1 (]: Began running node model.assignment1.edu-res
[0m11:41:21.409283 [info ] [Thread-1 (]: 1 of 4 START sql external model main.edu-res ................................... [RUN]
[0m11:41:21.411287 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.edu-res'
[0m11:41:21.411287 [debug] [Thread-1 (]: Began compiling node model.assignment1.edu-res
[0m11:41:21.420289 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.edu-res"
[0m11:41:21.420289 [debug] [Thread-1 (]: Timing info for model.assignment1.edu-res (compile): 11:41:21.411287 => 11:41:21.420289
[0m11:41:21.421362 [debug] [Thread-1 (]: Began executing node model.assignment1.edu-res
[0m11:41:21.463344 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:41:21.463344 [debug] [Thread-1 (]: On model.assignment1.edu-res: BEGIN
[0m11:41:21.464347 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:41:21.472371 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.473345 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:41:21.473345 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */

  
    
    

    create  table
      "dev"."main"."edu-res__dbt_tmp"
  
    as (
      

SELECT highest_education,
       SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
       SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
       SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
       SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY highest_education
    );
  
  
[0m11:41:21.543691 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.545692 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:41:21.546692 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
copy "dev"."main"."edu-res__dbt_tmp" to 'output/edu-res.csv' (format csv, header 1)
[0m11:41:21.548880 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.550881 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.edu-res"
[0m11:41:21.552881 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:41:21.552881 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
create or replace view "dev"."main"."edu-res__dbt_int" as (
        select * from 'output/edu-res.csv'
    );
[0m11:41:21.564037 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.574256 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:41:21.574256 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
alter view "dev"."main"."edu-res__dbt_int" rename to "edu-res"
[0m11:41:21.576252 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.591830 [debug] [Thread-1 (]: On model.assignment1.edu-res: COMMIT
[0m11:41:21.592830 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:41:21.592830 [debug] [Thread-1 (]: On model.assignment1.edu-res: COMMIT
[0m11:41:21.596830 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.601145 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:41:21.602152 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
drop table if exists "dev"."main"."edu-res__dbt_backup" cascade
[0m11:41:21.603152 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.606149 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:41:21.607159 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
drop table if exists "dev"."main"."edu-res__dbt_tmp" cascade
[0m11:41:21.609259 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.611447 [debug] [Thread-1 (]: Timing info for model.assignment1.edu-res (execute): 11:41:21.422285 => 11:41:21.610420
[0m11:41:21.611447 [debug] [Thread-1 (]: On model.assignment1.edu-res: Close
[0m11:41:21.620137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1662c88-038e-4d9a-aea4-d57972fbaab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B80A6952D0>]}
[0m11:41:21.621111 [info ] [Thread-1 (]: 1 of 4 OK created sql external model main.edu-res .............................. [[32mOK[0m in 0.21s]
[0m11:41:21.621111 [debug] [Thread-1 (]: Finished running node model.assignment1.edu-res
[0m11:41:21.622112 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:41:21.622112 [info ] [Thread-1 (]: 2 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:41:21.623111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.edu-res, now model.assignment1.my_first_dbt_model)
[0m11:41:21.624112 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:41:21.626111 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:41:21.627110 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:41:21.624112 => 11:41:21.627110
[0m11:41:21.627110 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:41:21.636327 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:41:21.638325 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:21.638325 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:41:21.639324 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:21.655327 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.655327 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:21.656325 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:41:21.657326 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.660326 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:21.660326 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:41:21.661328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.664325 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:21.664325 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:41:21.665328 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.673326 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:41:21.674328 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:21.674328 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:41:21.678324 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.682692 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:41:21.683694 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:41:21.686693 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.688947 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:41:21.628110 => 11:41:21.688947
[0m11:41:21.688947 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:41:21.696951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1662c88-038e-4d9a-aea4-d57972fbaab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B80A75FE10>]}
[0m11:41:21.697947 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m11:41:21.698947 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:41:21.700219 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:41:21.701222 [info ] [Thread-1 (]: 3 of 4 START sql external model main.test ...................................... [RUN]
[0m11:41:21.703221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:41:21.703221 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:41:21.706221 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:41:21.707224 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:41:21.704221 => 11:41:21.707224
[0m11:41:21.707224 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:41:21.711220 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:21.712220 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:41:21.712220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:21.726609 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.726609 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:21.727610 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      

WITH dim_reg_pass AS(
SELECT 
    region,
    SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
    SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
    SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
    SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY 
    region
)

SELECT 
 *
from dim_reg_pass
    );
  
  
[0m11:41:21.799260 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.800500 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:21.801499 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
copy "dev"."main"."test__dbt_tmp" to 'output/test.csv' (format csv, header 1)
[0m11:41:21.806498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.807500 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:41:21.808499 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:21.809501 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
create or replace view "dev"."main"."test__dbt_int" as (
        select * from 'output/test.csv'
    );
[0m11:41:21.820500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.822500 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:21.822500 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test" rename to "test__dbt_backup"
[0m11:41:21.823498 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.826499 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:21.827499 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test__dbt_int" rename to "test"
[0m11:41:21.827499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.829498 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:41:21.829498 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:21.830498 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:41:21.832500 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.835499 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:21.836500 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop view if exists "dev"."main"."test__dbt_backup" cascade
[0m11:41:21.838499 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.840800 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:41:21.840800 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_tmp" cascade
[0m11:41:21.842800 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.843801 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:41:21.708220 => 11:41:21.843801
[0m11:41:21.843801 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:41:21.850975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1662c88-038e-4d9a-aea4-d57972fbaab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B80A781790>]}
[0m11:41:21.851975 [info ] [Thread-1 (]: 3 of 4 OK created sql external model main.test ................................. [[32mOK[0m in 0.15s]
[0m11:41:21.852976 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:41:21.853976 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:41:21.853976 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:41:21.854976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:41:21.855976 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:41:21.857975 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:41:21.859136 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:41:21.855976 => 11:41:21.858975
[0m11:41:21.859136 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:41:21.875354 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:41:21.876354 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:21.877355 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:41:21.877355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:41:21.891790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.892790 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:21.892790 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:41:21.893790 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.895790 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:21.896790 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:41:21.897792 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.900126 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:21.901128 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:41:21.903140 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.905128 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:41:21.905128 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:21.906127 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:41:21.909364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.911364 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:41:21.912364 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:41:21.914364 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:41:21.915364 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:41:21.860160 => 11:41:21.915364
[0m11:41:21.915364 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:41:21.923563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1662c88-038e-4d9a-aea4-d57972fbaab8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B80A76F650>]}
[0m11:41:21.923563 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m11:41:21.925562 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:41:21.926563 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:21.927563 [debug] [MainThread]: On master: BEGIN
[0m11:41:21.928693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:41:21.941218 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:21.942220 [debug] [MainThread]: On master: COMMIT
[0m11:41:21.942220 [debug] [MainThread]: Using duckdb connection "master"
[0m11:41:21.943221 [debug] [MainThread]: On master: COMMIT
[0m11:41:21.943221 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:41:21.943221 [debug] [MainThread]: On master: Close
[0m11:41:21.945220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:41:21.946218 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:41:21.946218 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:41:21.947219 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:41:21.947219 [info ] [MainThread]: 
[0m11:41:21.948408 [info ] [MainThread]: Finished running 2 external models, 1 table model, 1 view model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m11:41:21.949411 [debug] [MainThread]: Command end result
[0m11:41:21.958771 [info ] [MainThread]: 
[0m11:41:21.959773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:41:21.960773 [info ] [MainThread]: 
[0m11:41:21.961773 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:41:21.962774 [debug] [MainThread]: Command `dbt run` succeeded at 11:41:21.962774 after 1.16 seconds
[0m11:41:21.963775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B80408C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B804119C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B804330150>]}
[0m11:41:21.963775 [debug] [MainThread]: Flushing usage events
[0m11:43:09.122850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACEEF7AAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACED5473D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACEEF83990>]}


============================== 11:43:09.122850 | 114f752e-860e-4e35-8336-ccec6864e496 ==============================
[0m11:43:09.122850 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:43:09.122850 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA\\assignment1\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:43:09.299472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '114f752e-860e-4e35-8336-ccec6864e496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACEF2D0750>]}
[0m11:43:09.377633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '114f752e-860e-4e35-8336-ccec6864e496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACEE74DE50>]}
[0m11:43:09.377633 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m11:43:09.393224 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:43:09.468097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:43:09.468097 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\edu-res\edu-res.sql
[0m11:43:09.565298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '114f752e-860e-4e35-8336-ccec6864e496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACECE7DD50>]}
[0m11:43:09.583539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '114f752e-860e-4e35-8336-ccec6864e496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACEF6E8310>]}
[0m11:43:09.583539 [info ] [MainThread]: Found 4 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m11:43:09.584624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '114f752e-860e-4e35-8336-ccec6864e496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACEF2A1810>]}
[0m11:43:09.584624 [info ] [MainThread]: 
[0m11:43:09.584624 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m11:43:09.584624 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m11:43:09.596750 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m11:43:09.598087 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m11:43:09.598087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:09.605322 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:09.605322 [debug] [ThreadPool]: On list_dev: Close
[0m11:43:09.605322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m11:43:09.605322 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m11:43:09.621676 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:43:09.621676 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m11:43:09.621676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:43:09.621676 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:09.621676 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:43:09.633021 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m11:43:09.634031 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:09.634886 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:43:09.635945 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m11:43:09.636894 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:09.638251 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:43:09.638251 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m11:43:09.638251 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m11:43:09.638251 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:09.638251 [debug] [ThreadPool]: On create_dev_main: Close
[0m11:43:09.638251 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m11:43:09.638251 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:43:09.638251 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m11:43:09.638251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:43:09.650953 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:09.650953 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m11:43:09.650953 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m11:43:09.685136 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m11:43:09.690124 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m11:43:09.691073 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m11:43:09.691073 [debug] [ThreadPool]: On list_dev_main: Close
[0m11:43:09.695108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '114f752e-860e-4e35-8336-ccec6864e496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACEF7BCB50>]}
[0m11:43:09.696124 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:09.696124 [debug] [MainThread]: On master: BEGIN
[0m11:43:09.697121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:43:09.703466 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:09.704476 [debug] [MainThread]: On master: COMMIT
[0m11:43:09.704476 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:09.704476 [debug] [MainThread]: On master: COMMIT
[0m11:43:09.705512 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:09.705512 [debug] [MainThread]: On master: Close
[0m11:43:09.708507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:43:09.709528 [info ] [MainThread]: 
[0m11:43:09.712520 [debug] [Thread-1 (]: Began running node model.assignment1.edu-res
[0m11:43:09.713513 [info ] [Thread-1 (]: 1 of 4 START sql external model main.edu-res ................................... [RUN]
[0m11:43:09.714506 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.edu-res'
[0m11:43:09.715752 [debug] [Thread-1 (]: Began compiling node model.assignment1.edu-res
[0m11:43:09.719480 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.edu-res"
[0m11:43:09.719480 [debug] [Thread-1 (]: Timing info for model.assignment1.edu-res (compile): 11:43:09.716787 => 11:43:09.719480
[0m11:43:09.719480 [debug] [Thread-1 (]: Began executing node model.assignment1.edu-res
[0m11:43:09.754056 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:43:09.754056 [debug] [Thread-1 (]: On model.assignment1.edu-res: BEGIN
[0m11:43:09.765742 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:43:09.768551 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.768551 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:43:09.768551 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */

  
    
    

    create  table
      "dev"."main"."edu-res__dbt_tmp"
  
    as (
      


WITH dim_edu_pass AS(
SELECT highest_education,
       SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
       SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
       SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
       SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY highest_education
)
SELECT 
 *
from dim_edu_pass
    );
  
  
[0m11:43:09.834907 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.834907 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:43:09.834907 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
copy "dev"."main"."edu-res__dbt_tmp" to 'output/edu-res.csv' (format csv, header 1)
[0m11:43:09.846797 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.847738 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.edu-res"
[0m11:43:09.848704 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:43:09.848704 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
create or replace view "dev"."main"."edu-res__dbt_int" as (
        select * from 'output/edu-res.csv'
    );
[0m11:43:09.852310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.852310 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:43:09.852310 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
alter view "dev"."main"."edu-res" rename to "edu-res__dbt_backup"
[0m11:43:09.852310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.852310 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:43:09.852310 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
alter view "dev"."main"."edu-res__dbt_int" rename to "edu-res"
[0m11:43:09.852310 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.868131 [debug] [Thread-1 (]: On model.assignment1.edu-res: COMMIT
[0m11:43:09.868131 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:43:09.868131 [debug] [Thread-1 (]: On model.assignment1.edu-res: COMMIT
[0m11:43:09.883195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.883195 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:43:09.883195 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
drop view if exists "dev"."main"."edu-res__dbt_backup" cascade
[0m11:43:09.883195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.883195 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m11:43:09.883195 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
drop table if exists "dev"."main"."edu-res__dbt_tmp" cascade
[0m11:43:09.883195 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.883195 [debug] [Thread-1 (]: Timing info for model.assignment1.edu-res (execute): 11:43:09.719480 => 11:43:09.883195
[0m11:43:09.883195 [debug] [Thread-1 (]: On model.assignment1.edu-res: Close
[0m11:43:09.900142 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '114f752e-860e-4e35-8336-ccec6864e496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACEF86BF10>]}
[0m11:43:09.900142 [info ] [Thread-1 (]: 1 of 4 OK created sql external model main.edu-res .............................. [[32mOK[0m in 0.19s]
[0m11:43:09.900142 [debug] [Thread-1 (]: Finished running node model.assignment1.edu-res
[0m11:43:09.900142 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m11:43:09.900142 [info ] [Thread-1 (]: 2 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m11:43:09.900142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.edu-res, now model.assignment1.my_first_dbt_model)
[0m11:43:09.900142 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m11:43:09.900142 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m11:43:09.900142 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 11:43:09.900142 => 11:43:09.900142
[0m11:43:09.900142 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m11:43:09.915943 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m11:43:09.915943 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:43:09.915943 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m11:43:09.915943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:09.936412 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.937445 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:43:09.937445 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m11:43:09.938392 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.940447 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:43:09.941447 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m11:43:09.941447 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.943623 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:43:09.944474 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m11:43:09.944774 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.950294 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:43:09.951529 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:43:09.952675 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m11:43:09.952675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.952675 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m11:43:09.952675 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m11:43:09.952675 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:09.952675 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 11:43:09.900142 => 11:43:09.952675
[0m11:43:09.952675 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m11:43:09.972814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '114f752e-860e-4e35-8336-ccec6864e496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACEF953310>]}
[0m11:43:09.972814 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m11:43:09.972814 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m11:43:09.974912 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m11:43:09.974912 [info ] [Thread-1 (]: 3 of 4 START sql external model main.test ...................................... [RUN]
[0m11:43:09.974912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m11:43:09.974912 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m11:43:09.974912 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m11:43:09.974912 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 11:43:09.974912 => 11:43:09.974912
[0m11:43:09.974912 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m11:43:09.985164 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:43:09.986185 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m11:43:09.987131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:10.004964 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.004964 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:43:10.004964 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      

WITH dim_reg_pass AS(
SELECT 
    region,
    SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
    SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
    SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
    SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY 
    region
)

SELECT 
 *
from dim_reg_pass
    );
  
  
[0m11:43:10.075620 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.076535 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:43:10.076535 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
copy "dev"."main"."test__dbt_tmp" to 'output/test.csv' (format csv, header 1)
[0m11:43:10.080573 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.081574 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m11:43:10.082724 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:43:10.083990 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
create or replace view "dev"."main"."test__dbt_int" as (
        select * from 'output/test.csv'
    );
[0m11:43:10.083990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.083990 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:43:10.083990 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test" rename to "test__dbt_backup"
[0m11:43:10.083990 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.100842 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:43:10.100842 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test__dbt_int" rename to "test"
[0m11:43:10.100842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.100842 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:43:10.100842 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:43:10.100842 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m11:43:10.100842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.100842 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:43:10.100842 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop view if exists "dev"."main"."test__dbt_backup" cascade
[0m11:43:10.100842 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.100842 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m11:43:10.100842 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_tmp" cascade
[0m11:43:10.115904 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.117217 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 11:43:09.974912 => 11:43:10.117217
[0m11:43:10.117217 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m11:43:10.124498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '114f752e-860e-4e35-8336-ccec6864e496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACEF9848D0>]}
[0m11:43:10.124498 [info ] [Thread-1 (]: 3 of 4 OK created sql external model main.test ................................. [[32mOK[0m in 0.15s]
[0m11:43:10.124498 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m11:43:10.124498 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m11:43:10.124498 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m11:43:10.124498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m11:43:10.124498 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m11:43:10.124498 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m11:43:10.133986 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 11:43:10.124498 => 11:43:10.133300
[0m11:43:10.135156 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m11:43:10.152868 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m11:43:10.152868 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:43:10.152868 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m11:43:10.167471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:43:10.181994 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.182784 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:43:10.182784 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m11:43:10.182784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.182784 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:43:10.182784 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m11:43:10.182784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.182784 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:43:10.182784 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m11:43:10.182784 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.198080 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:43:10.198080 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:43:10.198673 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m11:43:10.199580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.199580 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m11:43:10.199580 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m11:43:10.199580 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m11:43:10.199580 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 11:43:10.136164 => 11:43:10.199580
[0m11:43:10.199580 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m11:43:10.215294 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '114f752e-860e-4e35-8336-ccec6864e496', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACEF9A0390>]}
[0m11:43:10.216128 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.09s]
[0m11:43:10.216128 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m11:43:10.216128 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:10.216128 [debug] [MainThread]: On master: BEGIN
[0m11:43:10.216128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:43:10.234062 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:10.235011 [debug] [MainThread]: On master: COMMIT
[0m11:43:10.235011 [debug] [MainThread]: Using duckdb connection "master"
[0m11:43:10.235011 [debug] [MainThread]: On master: COMMIT
[0m11:43:10.235011 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m11:43:10.235011 [debug] [MainThread]: On master: Close
[0m11:43:10.235011 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:43:10.235011 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m11:43:10.235011 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m11:43:10.235011 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m11:43:10.235011 [info ] [MainThread]: 
[0m11:43:10.235011 [info ] [MainThread]: Finished running 2 external models, 1 table model, 1 view model in 0 hours 0 minutes and 0.65 seconds (0.65s).
[0m11:43:10.235011 [debug] [MainThread]: Command end result
[0m11:43:10.251991 [info ] [MainThread]: 
[0m11:43:10.253039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:43:10.253992 [info ] [MainThread]: 
[0m11:43:10.255601 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m11:43:10.255601 [debug] [MainThread]: Command `dbt run` succeeded at 11:43:10.255601 after 1.18 seconds
[0m11:43:10.255601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACE928C410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACE9518E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ACE935EAD0>]}
[0m11:43:10.255601 [debug] [MainThread]: Flushing usage events
[0m12:04:42.418686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C87C5BCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C87CAB2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C87CAAF50>]}


============================== 12:04:42.418686 | d9e39309-c851-4d25-843f-5ba5df668c46 ==============================
[0m12:04:42.418686 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:04:42.418686 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\ruben\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\ruben\\Documents\\coderen\\fase 3\\data-engeneering\\project OLA 2\\Data-engeneering-assignment-1\\assignment1\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:04:42.886191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9e39309-c851-4d25-843f-5ba5df668c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C87CED490>]}
[0m12:04:42.953167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9e39309-c851-4d25-843f-5ba5df668c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C87D8CA10>]}
[0m12:04:42.954037 [info ] [MainThread]: Registered adapter: duckdb=1.7.3
[0m12:04:42.970117 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:04:44.151432 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m12:04:44.152436 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\example\schema.yml
[0m12:04:44.152436 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\example\my_second_dbt_model.sql
[0m12:04:44.152436 [debug] [MainThread]: Partial parsing: updated file: assignment1://models\example\my_first_dbt_model.sql
[0m12:04:44.366889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9e39309-c851-4d25-843f-5ba5df668c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C87D013D0>]}
[0m12:04:44.368902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9e39309-c851-4d25-843f-5ba5df668c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C88424550>]}
[0m12:04:44.368902 [info ] [MainThread]: Found 4 models, 4 tests, 7 sources, 0 exposures, 0 metrics, 391 macros, 0 groups, 0 semantic models
[0m12:04:44.368902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9e39309-c851-4d25-843f-5ba5df668c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C87DD3410>]}
[0m12:04:44.368902 [info ] [MainThread]: 
[0m12:04:44.368902 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:04:44.368902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev'
[0m12:04:44.387479 [debug] [ThreadPool]: Using duckdb connection "list_dev"
[0m12:04:44.387479 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"dev"'
    
  
  
[0m12:04:44.387479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:44.409665 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:44.410364 [debug] [ThreadPool]: On list_dev: Close
[0m12:04:44.410364 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev, now create_dev_main)
[0m12:04:44.410364 [debug] [ThreadPool]: Creating schema "database: "dev"
schema: "main"
"
[0m12:04:44.420293 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:04:44.420293 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
        select type from duckdb_databases()
        where database_name='dev'
        and type='sqlite'
    
  
[0m12:04:44.421292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:44.423152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:44.423152 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:04:44.423152 [debug] [ThreadPool]: On create_dev_main: BEGIN
[0m12:04:44.423152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:44.423152 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:04:44.423152 [debug] [ThreadPool]: On create_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "create_dev_main"} */

    
    
        create schema if not exists "dev"."main"
    
[0m12:04:44.423152 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:44.423152 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:04:44.423152 [debug] [ThreadPool]: Using duckdb connection "create_dev_main"
[0m12:04:44.434840 [debug] [ThreadPool]: On create_dev_main: COMMIT
[0m12:04:44.435847 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:44.436353 [debug] [ThreadPool]: On create_dev_main: Close
[0m12:04:44.440375 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_dev_main'
[0m12:04:44.444373 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:04:44.444373 [debug] [ThreadPool]: On list_dev_main: BEGIN
[0m12:04:44.445374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:44.451620 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:44.452633 [debug] [ThreadPool]: Using duckdb connection "list_dev_main"
[0m12:04:44.452633 [debug] [ThreadPool]: On list_dev_main: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "connection_name": "list_dev_main"} */
select
      'dev' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'dev'
  
[0m12:04:44.480562 [debug] [ThreadPool]: SQL status: OK in 0.0 seconds
[0m12:04:44.484562 [debug] [ThreadPool]: On list_dev_main: ROLLBACK
[0m12:04:44.485583 [debug] [ThreadPool]: Failed to rollback 'list_dev_main'
[0m12:04:44.485583 [debug] [ThreadPool]: On list_dev_main: Close
[0m12:04:44.485583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9e39309-c851-4d25-843f-5ba5df668c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C88054ED0>]}
[0m12:04:44.485583 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:44.485583 [debug] [MainThread]: On master: BEGIN
[0m12:04:44.485583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:04:44.485583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:04:44.485583 [debug] [MainThread]: On master: COMMIT
[0m12:04:44.485583 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:44.485583 [debug] [MainThread]: On master: COMMIT
[0m12:04:44.485583 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:04:44.485583 [debug] [MainThread]: On master: Close
[0m12:04:44.501760 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:04:44.503050 [info ] [MainThread]: 
[0m12:04:44.504462 [debug] [Thread-1 (]: Began running node model.assignment1.edu-res
[0m12:04:44.504462 [info ] [Thread-1 (]: 1 of 4 START sql external model main.edu-res ................................... [RUN]
[0m12:04:44.504462 [debug] [Thread-1 (]: Acquiring new duckdb connection 'model.assignment1.edu-res'
[0m12:04:44.504462 [debug] [Thread-1 (]: Began compiling node model.assignment1.edu-res
[0m12:04:44.504462 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.edu-res"
[0m12:04:44.504462 [debug] [Thread-1 (]: Timing info for model.assignment1.edu-res (compile): 12:04:44.504462 => 12:04:44.504462
[0m12:04:44.504462 [debug] [Thread-1 (]: Began executing node model.assignment1.edu-res
[0m12:04:44.549162 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m12:04:44.549162 [debug] [Thread-1 (]: On model.assignment1.edu-res: BEGIN
[0m12:04:44.550145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:04:44.554689 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.554689 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m12:04:44.554689 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */

  
    
    

    create  table
      "dev"."main"."edu-res__dbt_tmp"
  
    as (
      


WITH dim_edu_pass AS(
SELECT highest_education,
       SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
       SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
       SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
       SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY highest_education
)
SELECT 
 *
from dim_edu_pass
    );
  
  
[0m12:04:44.623769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.623769 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m12:04:44.623769 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
copy "dev"."main"."edu-res__dbt_tmp" to 'output/edu-res.csv' (format csv, header 1)
[0m12:04:44.623769 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.623769 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.edu-res"
[0m12:04:44.634615 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m12:04:44.635622 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
create or replace view "dev"."main"."edu-res__dbt_int" as (
        select * from 'output/edu-res.csv'
    );
[0m12:04:44.641639 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.646639 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m12:04:44.646639 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
alter view "dev"."main"."edu-res" rename to "edu-res__dbt_backup"
[0m12:04:44.647621 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.649643 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m12:04:44.650639 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
alter view "dev"."main"."edu-res__dbt_int" rename to "edu-res"
[0m12:04:44.651561 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.661565 [debug] [Thread-1 (]: On model.assignment1.edu-res: COMMIT
[0m12:04:44.662567 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m12:04:44.662567 [debug] [Thread-1 (]: On model.assignment1.edu-res: COMMIT
[0m12:04:44.665564 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.668697 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m12:04:44.668697 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
drop view if exists "dev"."main"."edu-res__dbt_backup" cascade
[0m12:04:44.668697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.668697 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.edu-res"
[0m12:04:44.668697 [debug] [Thread-1 (]: On model.assignment1.edu-res: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.edu-res"} */
drop table if exists "dev"."main"."edu-res__dbt_tmp" cascade
[0m12:04:44.668697 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.668697 [debug] [Thread-1 (]: Timing info for model.assignment1.edu-res (execute): 12:04:44.504462 => 12:04:44.668697
[0m12:04:44.668697 [debug] [Thread-1 (]: On model.assignment1.edu-res: Close
[0m12:04:44.684325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e39309-c851-4d25-843f-5ba5df668c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C88716ED0>]}
[0m12:04:44.684325 [info ] [Thread-1 (]: 1 of 4 OK created sql external model main.edu-res .............................. [[32mOK[0m in 0.18s]
[0m12:04:44.684325 [debug] [Thread-1 (]: Finished running node model.assignment1.edu-res
[0m12:04:44.684325 [debug] [Thread-1 (]: Began running node model.assignment1.my_first_dbt_model
[0m12:04:44.684325 [info ] [Thread-1 (]: 2 of 4 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m12:04:44.684325 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.edu-res, now model.assignment1.my_first_dbt_model)
[0m12:04:44.684325 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_first_dbt_model
[0m12:04:44.684325 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_first_dbt_model"
[0m12:04:44.684325 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (compile): 12:04:44.684325 => 12:04:44.684325
[0m12:04:44.684325 [debug] [Thread-1 (]: Began executing node model.assignment1.my_first_dbt_model
[0m12:04:44.684325 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_first_dbt_model"
[0m12:04:44.699950 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m12:04:44.699950 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: BEGIN
[0m12:04:44.699950 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:44.699950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.699950 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m12:04:44.699950 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */

  
    
    

    create  table
      "dev"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m12:04:44.699950 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.699950 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m12:04:44.699950 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m12:04:44.715595 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.718965 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m12:04:44.719941 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
alter table "dev"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m12:04:44.721360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.721360 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m12:04:44.721360 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m12:04:44.721360 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: COMMIT
[0m12:04:44.721360 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.721360 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_first_dbt_model"
[0m12:04:44.721360 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_first_dbt_model"} */
drop table if exists "dev"."main"."my_first_dbt_model__dbt_backup" cascade
[0m12:04:44.735256 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.735256 [debug] [Thread-1 (]: Timing info for model.assignment1.my_first_dbt_model (execute): 12:04:44.684325 => 12:04:44.735256
[0m12:04:44.735256 [debug] [Thread-1 (]: On model.assignment1.my_first_dbt_model: Close
[0m12:04:44.735256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e39309-c851-4d25-843f-5ba5df668c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C88A19350>]}
[0m12:04:44.735256 [info ] [Thread-1 (]: 2 of 4 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m12:04:44.750263 [debug] [Thread-1 (]: Finished running node model.assignment1.my_first_dbt_model
[0m12:04:44.751286 [debug] [Thread-1 (]: Began running node model.assignment1.test
[0m12:04:44.752303 [info ] [Thread-1 (]: 3 of 4 START sql external model main.test ...................................... [RUN]
[0m12:04:44.753302 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.my_first_dbt_model, now model.assignment1.test)
[0m12:04:44.754316 [debug] [Thread-1 (]: Began compiling node model.assignment1.test
[0m12:04:44.757302 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.test"
[0m12:04:44.758303 [debug] [Thread-1 (]: Timing info for model.assignment1.test (compile): 12:04:44.754316 => 12:04:44.757302
[0m12:04:44.758303 [debug] [Thread-1 (]: Began executing node model.assignment1.test
[0m12:04:44.762301 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m12:04:44.762301 [debug] [Thread-1 (]: On model.assignment1.test: BEGIN
[0m12:04:44.763302 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:44.778443 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.779463 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m12:04:44.779463 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */

  
    
    

    create  table
      "dev"."main"."test__dbt_tmp"
  
    as (
      

WITH dim_reg_pass AS(
SELECT 
    region,
    SUM(CASE WHEN final_result = 'Pass' THEN 1 ELSE 0 END) AS pass_count,
    SUM(CASE WHEN final_result = 'Withdrawn' THEN 1 ELSE 0 END) AS withdrawn_count,
    SUM(CASE WHEN final_result = 'Fail' THEN 1 ELSE 0 END) AS fail_count,
    SUM(CASE WHEN final_result = 'Distinction' THEN 1 ELSE 0 END) AS distinction_count
FROM 
    'data/studentInfo.csv'
GROUP BY 
    region
)

SELECT 
 *
from dim_reg_pass
    );
  
  
[0m12:04:44.835146 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.835146 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m12:04:44.835146 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
copy "dev"."main"."test__dbt_tmp" to 'output/test.csv' (format csv, header 1)
[0m12:04:44.851049 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.851844 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.test"
[0m12:04:44.851844 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m12:04:44.851844 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
create or replace view "dev"."main"."test__dbt_int" as (
        select * from 'output/test.csv'
    );
[0m12:04:44.851844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.851844 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m12:04:44.851844 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test" rename to "test__dbt_backup"
[0m12:04:44.851844 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.867708 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m12:04:44.868703 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
alter view "dev"."main"."test__dbt_int" rename to "test"
[0m12:04:44.868703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.868703 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m12:04:44.868703 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m12:04:44.868703 [debug] [Thread-1 (]: On model.assignment1.test: COMMIT
[0m12:04:44.868703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.868703 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m12:04:44.868703 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop view if exists "dev"."main"."test__dbt_backup" cascade
[0m12:04:44.868703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.868703 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.test"
[0m12:04:44.868703 [debug] [Thread-1 (]: On model.assignment1.test: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.test"} */
drop table if exists "dev"."main"."test__dbt_tmp" cascade
[0m12:04:44.868703 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.884542 [debug] [Thread-1 (]: Timing info for model.assignment1.test (execute): 12:04:44.759303 => 12:04:44.884542
[0m12:04:44.884542 [debug] [Thread-1 (]: On model.assignment1.test: Close
[0m12:04:44.886956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e39309-c851-4d25-843f-5ba5df668c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C88763950>]}
[0m12:04:44.886956 [info ] [Thread-1 (]: 3 of 4 OK created sql external model main.test ................................. [[32mOK[0m in 0.13s]
[0m12:04:44.886956 [debug] [Thread-1 (]: Finished running node model.assignment1.test
[0m12:04:44.886956 [debug] [Thread-1 (]: Began running node model.assignment1.my_second_dbt_model
[0m12:04:44.886956 [info ] [Thread-1 (]: 4 of 4 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m12:04:44.886956 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.assignment1.test, now model.assignment1.my_second_dbt_model)
[0m12:04:44.886956 [debug] [Thread-1 (]: Began compiling node model.assignment1.my_second_dbt_model
[0m12:04:44.886956 [debug] [Thread-1 (]: Writing injected SQL for node "model.assignment1.my_second_dbt_model"
[0m12:04:44.886956 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (compile): 12:04:44.886956 => 12:04:44.886956
[0m12:04:44.886956 [debug] [Thread-1 (]: Began executing node model.assignment1.my_second_dbt_model
[0m12:04:44.910337 [debug] [Thread-1 (]: Writing runtime sql for node "model.assignment1.my_second_dbt_model"
[0m12:04:44.911335 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m12:04:44.912228 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: BEGIN
[0m12:04:44.912228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:44.922456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.922456 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m12:04:44.922456 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */

  
  create view "dev"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."main"."my_first_dbt_model"
where id = 1
  );

[0m12:04:44.922456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.922456 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m12:04:44.922456 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m12:04:44.922456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.922456 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m12:04:44.922456 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
alter view "dev"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m12:04:44.922456 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.934552 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m12:04:44.935559 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m12:04:44.935980 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: COMMIT
[0m12:04:44.935980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.935980 [debug] [Thread-1 (]: Using duckdb connection "model.assignment1.my_second_dbt_model"
[0m12:04:44.935980 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "assignment1", "target_name": "dev", "node_id": "model.assignment1.my_second_dbt_model"} */
drop view if exists "dev"."main"."my_second_dbt_model__dbt_backup" cascade
[0m12:04:44.935980 [debug] [Thread-1 (]: SQL status: OK in 0.0 seconds
[0m12:04:44.935980 [debug] [Thread-1 (]: Timing info for model.assignment1.my_second_dbt_model (execute): 12:04:44.886956 => 12:04:44.935980
[0m12:04:44.935980 [debug] [Thread-1 (]: On model.assignment1.my_second_dbt_model: Close
[0m12:04:44.935980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e39309-c851-4d25-843f-5ba5df668c46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C88A543D0>]}
[0m12:04:44.935980 [info ] [Thread-1 (]: 4 of 4 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.05s]
[0m12:04:44.951010 [debug] [Thread-1 (]: Finished running node model.assignment1.my_second_dbt_model
[0m12:04:44.953123 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:44.953123 [debug] [MainThread]: On master: BEGIN
[0m12:04:44.953123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:04:44.967016 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:04:44.967848 [debug] [MainThread]: On master: COMMIT
[0m12:04:44.967848 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:44.967848 [debug] [MainThread]: On master: COMMIT
[0m12:04:44.968879 [debug] [MainThread]: SQL status: OK in 0.0 seconds
[0m12:04:44.968879 [debug] [MainThread]: On master: Close
[0m12:04:44.970936 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:44.970936 [debug] [MainThread]: Connection 'create_dev_main' was properly closed.
[0m12:04:44.971981 [debug] [MainThread]: Connection 'list_dev_main' was properly closed.
[0m12:04:44.971981 [debug] [MainThread]: Connection 'model.assignment1.my_second_dbt_model' was properly closed.
[0m12:04:44.972879 [info ] [MainThread]: 
[0m12:04:44.972879 [info ] [MainThread]: Finished running 2 external models, 1 table model, 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m12:04:44.974078 [debug] [MainThread]: Command end result
[0m12:04:45.023311 [info ] [MainThread]: 
[0m12:04:45.023311 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:45.023311 [info ] [MainThread]: 
[0m12:04:45.023311 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m12:04:45.034396 [debug] [MainThread]: Command `dbt run` succeeded at 12:04:45.034396 after 2.72 seconds
[0m12:04:45.034396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C82019C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C824902D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020C8205EB50>]}
[0m12:04:45.035403 [debug] [MainThread]: Flushing usage events
